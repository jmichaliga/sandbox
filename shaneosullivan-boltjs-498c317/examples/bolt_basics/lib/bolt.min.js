var require,modjewel;(function(){function x(a){console.log("modjewel: "+a)}function w(a,c,d){c.VERSION=b,c.require=a,c.define=a.define,c.getLoadedModuleIds=q,c.getPreloadedModuleIds=r,c.getModule=s,c.getModuleIdsRequired=t,c.warnOnRecursiveRequire=u,c.noConflict=v}function v(){d=!0,require=c}function u(a){if(arguments.length==0)return h;h=!!a}function t(a){var b=s(a);if(null==b)return null;return b.moduleIdsRequired.slice()}function s(a){if(null==a)return g;return e[a]}function r(){var a=[];for(moduleId in f)a.push(moduleId);return a}function q(){var a=[];for(moduleId in e)a.push(moduleId);return a}function p(b){throw new Error(a+": "+b)}function o(a,b){var c=n(a),d=""==c?[]:c.split("/"),e=b.split("/");for(var f=0;f<e.length;f++){var g=e[f];g!="."&&(g==".."?d.length>0&&d.pop():d.push(g))}return d.join("/")}function n(a){if(!a||!a.id)return"";var b=a.id.split("/");return b.slice(0,b.length-1).join("/")}function m(a){for(var b in a){if(!j(a,b))continue;if(b.match(/^\./)){console.log("require.define(): moduleName in moduleSet must not start with '.': '"+b+"'");return}var c=a[b];if(typeof c!="function"){console.log("require.define(): expecting a function as value of '"+b+"' in moduleSet");return}if(j(f,b)){console.log("require.define(): module '"+b+"' has already been preloaded");return}f[b]=c}}function l(){e={},f={},g=k(null),require=i(g),require.define({modjewel:w}),modjewel=require("modjewel")}function k(a){return{id:a,uri:a,exports:{},moduleIdsRequired:[]}}function j(a,b){return Object.prototype.hasOwnProperty.call(a,b)}function i(c){var d=function(a){a.match(/^\.{1,2}\//)&&(a=o(c,a));if(j(e,a)){var b=e[a];if(b.__isLoading&&h){var d=c?c.id:"<root>";console.log("module '"+a+"' recursively require()d from '"+d+"', problem?")}c.moduleIdsRequired.push(a);return b.exports}if(!j(f,a)){var d=c?c.id:"<root>";p("module '"+a+"' not found from '"+d+"', must be preloaded")}var g=f[a],b=k(a),l=i(b);e[a]=b,b.__isLoading=!0;try{c.moduleIdsRequired.push(a),g.call(null,l,b.exports,b)}finally{b.__isLoading=!1}return b.exports};d.define=m,d.implementation=a,d.version=b;return d}var a="modjewel",b="1.1.0";if(modjewel)x("modjewel global variable already defined");else{var c=require,d=!1,e,f,g,h=!1;l()}})(),window.require=require,require.define({binding:function(a,b,c){__DEV__=0;var d=a("util"),e=a("javelin/core"),f=e.createClass({name:"Binding",construct:function(a,b,c){this.setView(a),this.setModel(b),c=c||{},c.property&&!c.modelProperty&&!c.viewProperty&&(c.modelProperty=c.viewProperty=c.property),d.forEach(c,function(a,b){this[d.setter(b)](a)},this);var e=d.$A(this.getViewEvent());this.viewTokens=[];for(var f=0;f<e.length;f++)this.viewTokens.push(this.getView().listen(this.getViewEvent(),d.bind(this.updateModel,this)));this.modelToken=this.getModel().listen("changed",d.bind(this.updateView,this)),c.sync!==!1&&this.setViewValue(this.getModelValue())},properties:{model:null,modelProperty:"value",view:null,viewEvent:"blur",viewProperty:"value",property:"value"},members:{destroy:function(){d.invoke(this.viewTokens,"remove"),this.modelToken.remove()},getViewValue:function(){return this.getView()[d.getter(this.getViewProperty())]()},setViewValue:function(a){this.getView()[d.setter(this.getViewProperty())](a),this.setViewErrorState();return this},getModelValue:function(){return this.getModel().get(this.getModelProperty())},setModelValue:function(a){this.getModel().set(this.getModelProperty(),a),this.setViewErrorState();return this},setViewErrorState:function(){this.getView().setErrorState(this.getViewProperty(),!this.getModel().isValid(this.getModelProperty()))},updateModel:function(a){this.getViewValue()!=this.getModelValue()&&this.setModelValue(this.getViewValue())},updateView:function(a){var b=this.getModelProperty(),c=this.getModelValue(),d=this.getViewValue(),e=(a.changedProperties||{}).hasOwnProperty(b)!==!1;e&&d!==c&&a.source!==this&&this.setViewValue(this.getModelValue())}}});b.Binding=f}}),require.define({builder:function(a,b,c){function h(a,b){var c=g;g=a;var d=b.call(a);g=c;return d}__DEV__=0;var d=a("util"),e=a("javelin/core"),f=e.createClass({construct:function(b){this.setNamespace(b||a("view"))},properties:{namespace:null},members:{build:function(a,b){return h(this,function(){if(a.length||a.length===0)return d.map(a,function(a){return this.buildOne(a,b)},this);return this.buildOne(a,b)})},buildOne:function(a,b){if(a.createDom)return a;var c=a.view||"View",e;d.isFunction(c)?e=c:e=this.getNamespace()[c],e||console.error("The view "+c+" is not defined"),a.construct&&(console.log("the construct hash in builder is deprectated"),d.forEach(a.construct,function(b,c){a[c]=b})),a.owner=a.owner||b;try{e=new e(a)}catch(f){console.log("Invalid view configuration",c,a);throw f}return e}}}),g=new f;b.build=function(a,b){return g.build(a,b)},b.Builder=f}}),require.define({collection:function(a,b,c){__DEV__=0;var d=a("util"),e=a("javelin/core"),f=a("model").Model,g=a("mixins/events").Events,h=e.createClass({name:"Collection",construct:function(a){this.length=0,this.models=[],this._byCid={},this._byId={},this._listeners={},a=a||{},this.modelType=a.modelType||this.klass.modelType},statics:{modelType:f},mixins:[g],members:{add:function(a,b){if(!a.klass)a=new this.modelType(a);else{var c=a.klass.inheritanceChain;if(!c||c[c.length-1].klassName!=="Model")a=new this.modelType(a)}var e=a.cid,f=a.id;if(!this._byCid[e]&&(!f||!this._byId[f])){var g=this.comparator?this.sortedIndex(a,this.comparator):this.length;this.models.splice(g,0,a),this._byCid[e]=a,a.id!==null&&(this._byId[f]=a),this.length++,this._boundModelChange=this._boundModelChange||d.bind(this._onModelChanged,this),this._listeners[e]=a.listen("changed",this._boundModelChange),b||this._invoke("modelAdded",{model:a});return!0}return!1},remove:function(a,b){var c=a.cid,d=a.id;if(this._byCid[c]){delete this._byCid[c],delete this._byId[d];var e=this.indexOf(a);this.models.splice(e,1),this.length--,b||this._invoke("modelRemoved",{model:a});var f=this._listeners[c];f&&f.remove()}},clear:function(a){this._byCid={},this._byId={},this.models=[],this.length=0,a||this._invoke("updated",{collection:this})},replace:function(a,b){this.clear(!0),this.merge(a,b)},merge:function(a){var b=!1;d.isArray(a)||(a=[a]),d.forEach(a,function(a){var c=this.get(a.id);if(!c){var d=this.add(a,!0);d&&(b=!0)}else{var e=c.merge(a.toObject(),!0);b=b||!!e}},this),b&&this._invoke("updated",{collection:this})},sort:function(a){if(!this.comparator)return!1;this.models=this.sortBy(this.comparator),a||this._invoke("updated",{collection:this});return this},get:function(a){return this._byId[a]},getIds:function(a){return this.map(function(a){return a.id})},getByCid:function(a){return this._byCid[a]},at:function(a){return this.models[a]},_onModelChanged:function(a){this._invoke("modelChanged",a);var b=(a.changedProperties||{})[this.sortKey]!==undefined;b&&this.sort()},_invoke:function(a,b){b=b||{},b.evt=a,this.invoke(a,b)}}}),i=["filter","forEach","each","map","include","without","find","first","last","isEmpty","toArray","select","reject","indexOf","sortBy","sortedIndex"];d.forEach(i,function(a){h.prototype[a]=function(){return d[a].apply(this,[this.models].concat(d.toArray(arguments)))}}),b.Collection=h}}),require.define({collection_view:function(a,b,c){__DEV__=0;var d=a("util"),e=a("builder").build,f=a("view").View,g=a("collection").Collection,h=a("javelin/core").createClass({name:"CollectionView",extend:f,properties:{collection:null,modelViewMapping:{},defaultOptions:null},construct:function(a){this.itemViews={},this._collectionTokens=[],this._onCollectionEvent=d.bind(this._onCollectionEvent,this),a.collection=a.collection||new g,a.viewForModel&&(this.viewForModel=d.bind(a.viewForModel,this),delete a.viewForModel),f.call(this,a)},members:{viewForModel:function(a){return this._viewFromModelMapping(a)},insertCollectionChild:function(a,b){this.insertChild(a,b)},removeCollectionChild:function(a){this.removeChild(a)},onModelAdded:function(a){var b=this.viewForModel(a);b.getModel()!==a&&b.setModel(a),this.itemViews[a.cid]=b;var c=this.getCollection().indexOf(a);this.insertCollectionChild(b,c);return b},onModelRemoved:function(a){var b=this.itemViews[a.cid];b&&(this.removeCollectionChild(b),delete this.itemViews[a.cid])},onUpdated:function(){this.clearChildren(),console.log("childViews.length",this.getChildViews().length),this.getCollection().each(function(a){this.onModelAdded(a)},this)},onModelChanged:function(a){},setCollection:function(a){var b=this.getProperty("collection");b&&(d.invoke(this._collectionTokens,"remove"),this._collectionTokens=[]),this.setProperty("collection",a),this[name]=a,a&&this._collectionTokens.push(a.listen("modelChanged",this._onCollectionEvent),a.listen("modelAdded",this._onCollectionEvent),a.listen("modelRemoved",this._onCollectionEvent),a.listen("updated",this._onCollectionEvent)),this.onUpdated();return this},destroy:function(){d.invoke(this._collectionTokens,"remove"),f.prototype.destroy.call(this)},_onCollectionEvent:function(a){var b=d.eventHandler(a.evt);this[b]&&this[b](a.model)},_viewFromModelMapping:function(a){var b=a.getDeclaredClass();b=b.replace(/^JX\./,"");var c=this.getModelViewMapping()[b];if(!c)throw"received a model without a mapping";var d=this.build(c);d.setBinding(a,c.bindingConfig,this.getDefaultOptions());return d}}});b.CollectionView=h}}),require.define({container:function(a,b,c){__DEV__=0,b.Container=a("view").View}}),require.define({deferred:function(a,b,c){function k(a,b,c){for(var d=0;d<a.length;d++)a[d].apply(b,c)}__DEV__=0;var d=a("util"),e=a("javelin/core"),f=0,g=1,h=2,i=e.createClass({name:"Deferred",construct:function(){this.callbacks=[],this.errbacks=[]},properties:{status:f},members:{addCallback:function(a){this.getStatus()===g?a():this.callbacks.push(a);return this},removeCallback:function(a){this.callbacks=d.without(this.callbacks,a);return this},addErrback:function(a){this.getStatus()===h?a():this.errbacks.push(a);return this},removeErrback:function(a){this.errbacks=d.without(this.errbacks,a);return this},setStatus:function(a){this.setProperty(a);var b=d.toArray(arguments).slice(1);if(a===h){var c=this.errbacks;this.errbacks=[],k(c,this,b)}else if(a===g){var e=this.callbacks;this.callbacks=[],k(e,this,b)}return this},setTimeout:function(a){this.timeout=setTimeout(d.bind(this.fail,this),a)},clearTimeout:function(){clearTimeout(this.timeout)},succeed:function(){var a=[g].concat(d.toArray(arguments));return this.setStatus.apply(this,a)},fail:function(){var a=[h].concat(d.toArray(arguments));return this.setStatus.apply(this,a)}}}),j=e.createClass({name:"DeferredList",extend:i,construct:function(a){i.call(this),this.completed=0,a?(d.forEach(a,this.waitFor,this),this.startWaiting()):this.list=[]},members:{startWaiting:function(){this.waiting=!0,this.checkDeferreds();return this},waitFor:function(a){this.list.push(a),this.checkDeferreds(),a.addCallback(d.bind(this.deferredComplete,this)),a.addErrback(d.bind(this.deferredComplete,this));return this},createWaitForDeferred:function(){var a=new i;this.waitFor(a);return a},createWaitForCallback:function(){var a=this.createWaitForDeferred();return d.bind(a.succeed,a)},deferredComplete:function(){this.completed++,this.completed===this.list.length&&this.checkDeferreds()},checkDeferreds:function(){if(!!this.waiting&&this.completed===this.list.length){var a=!1;for(var b=0;b<this.list.length;b++)this.list[b].getStatus()===h&&(a=!0);this.setStatus(a?h:g)}}}});b.Deferred=i,b.DeferredList=j,b.STATUS_UNKNOWN=f,b.STATUS_SUCCEEDED=g,b.STATUS_FAILED=h}}),require.define({"javelin/core":function(a,b,c){function i(a){a.members=a.members||{},a.events=a.events||[],a.members.getDeclaredClass=e,a.members.getProperty=g,a.members.setProperty=f;var b=d.$A(a.mixins||[]);delete a.mixins;while(b.length){var c=b.shift();d.copy(a.members,c)}a.name=a.name||"BoltObject";var i;!a.beforeCreateClass&&a.extend&&(a.beforeCreateClass=a.extend.beforeCreateClass),i=a.beforeCreateClass||function(a){return a},a=i(a),delete a.beforeCreateClass,!a.afterCreateClass&&a.extend&&(a.afterCreateClass=a.extend.afterCreateClass);var j=a.afterCreateClass||function(){};delete a.afterCreateClass;for(key in a)h[key]||(a.members[key]=a[key]);var k=d.createClass(a);k.beforeCreateClass=i,k.klassName=a.name,k.prototype.klass=k,k.superKlass=a.extend,k.prototype.superKlass=k.superKlass;var l=[],m=k;while(m)l.push(m),m=m.superKlass;k.inheritanceChain=l,k.afterCreateClass=j,k.afterCreateClass.call(k,a);return k}function g(a){return this["__auto__"+a]}function f(a,b){this["__auto__"+a]=b}function e(){return this.klass.klassName}__DEV__=0;var d=a("JX"),h={construct:!0,statics:!0,members:!0,extend:!0,properties:!0,events:!0,name:!0,beforeCreateClass:!0,afterCreateClass:!0};b.createClass=i}}),require.define({"javelin/dom":function(a,b,c){__DEV__=0,c.exports=a("JX").DOM,c.exports.$N=a("JX").$N}}),require.define({"javelin/stratcom":function(a,b,c){__DEV__=0,c.exports=a("JX").Stratcom}}),require.define({"javelin/vector":function(a,b,c){__DEV__=0,c.exports=a("JX").Vector,c.exports.$V=a("JX").$V}}),require.define({"mixins/events":function(a,b,c){__DEV__=0;var d=a("util"),e=0,f=function(a,b,c){this.id=e++,this.obj=a,this.ev=b,this.callback=c};f.prototype.remove=function(){this.obj.removeListener(this.ev,this.callback)},b.Events={listen:function(a,b){var c=this._callbacks||(this._callbacks={}),d=c[a]||(c[a]=[]);d.push(b);return new f(this,a,b)},removeListener:function(a,b){var c;if(!a)delete this._callbacks;else if(c=this._callbacks)if(!b)delete c[a];else{var d=c[a];for(var e=0,f=d.length;e<f;e++)if(b===d[e]){d.splice(e,1);break}}return this},invoke:function(a){var b,c,e,f;if(!(c=this._callbacks))return this;if(c[a]&&(b=d.clone(c[a])))for(e=0,f=b.length;e<f;e++)b[e].apply(this,Array.prototype.slice.call(arguments,1));if(c.all&&(b=d.clone(c.all)))for(e=0,f=b.length;e<f;e++)b[e].apply(this,arguments);return this}}}}),require.define({"mixins/filterable_collection":function(a,b,c){__DEV__=0;var d=a("collection").Collection,e=a("util"),f=0,g=b.FilterableCollection={destroyFilteredCollection:function(a){delete this._filtersById[a._fcid],this._filters=e.values(this._filtersById)},getCollectionByFilter:function(a,b){this._filterableCollectionInitialized||this._initializeFilterableCollection();var c=new(b||d);c._fcid=f++;var g=this;c.destroy=function(){g.destroyFilteredCollection(c)},this.comparator&&!c.comparator&&(c.comparator=this.comparator);var h=this.filter(a);c.replace(h,!0),this._filtersById[c._fcid]={filterFunction:a,filteredCollection:c},this._filters=e.values(this._filtersById);return c},getCollectionByProperty:function(a,b,c){var d=function(c){return c.get(a)===b};return this.getCollectionByFilter(d,c)},processFilterEvent:function(a,b){switch(a){case"updated":this.processUpdateEvent(b);break;case"modelChanged":this.processModelChangedEvent(b);break;case"modelRemoved":this.processModelRemovedEvent(b);break;case"modelAdded":this.processModelAddedEvent(b);break;default:}},processUpdateEvent:function(a){var b,c,d;for(var e=0,f=this._filters.length;e<f;e++){b=this._filters[e],c=b.filterFunction,d=b.filteredCollection;var g=this.filter(c);d.replace(g)}},processModelChangedEvent:function(a){var b,c,d,e=a.model,f;for(var g=0,h=this._filters.length;g<h;g++)b=this._filters[g],c=b.filterFunction,d=b.filteredCollection,f=c(e),f?d.add(e):d.remove(e)},processModelRemovedEvent:function(a){var b,c,d,e=a.model,f;for(var g=0,h=this._filters.length;g<h;g++)b=this._filters[g],c=b.filterFunction,d=b.filteredCollection,d.remove(e)},processModelAddedEvent:function(a){var b,c,d,e=a.model,f;for(var g=0,h=this._filters.length;g<h;g++)b=this._filters[g],c=b.filterFunction,d=b.filteredCollection,f=c(e),f&&d.add(e)},_initializeFilterableCollection:function(){this._filtersById={},this._filters=[],this._filterableCollectionInitialized=!0,this.listen("all",e.bind(this.processFilterEvent,this))}}}}),require.define({model:function(a,b,c){__DEV__=0;var d=a("util"),e=a("javelin/core"),f=a("mixins/events").Events,g=e.createClass({name:"Model",mixins:[f],construct:function(a){this._properties={},this.setAll(a),this.cid=this.__id__},members:{get:function(a){return this._properties[a]},set:function(a,b,c){var e=this._properties[a];if(!d.isEqual(e,b)){this._properties[a]=b,a==="id"&&(this.id=b);var f={};f[a]=e,c||this.invoke("changed",{model:this,changedProperties:f});return f}return!1},unset:function(a,b){var c=this._properties[a];if(c!==undefined&&c!==null){this._properties[a]=null;var d={};d[a]=c,b||this.invoke("changed",{changedProperties:d});return d}return!1},setAll:function(a,b){var c={};d.forEach(a,function(a,b){var e=this.set(b,a,!0);e&&(c=d.extend(c,e))},this);if(!d.isEmpty(c)){b||this.invoke("changed",{changedProperties:c});return c}return!1},merge:function(a,b){return this.setAll(a,b)},isValid:function(a){return!0},eachProperty:function(a,b){d.each(this._properties,a,b)},toObject:function(){return d.extend({},this._properties)}}});b.Model=g}}),require.define({util:function(a,b,c){__DEV__=0,c.exports=b=a("_");var d=a("JX");b.$A=d.$A,b.$AX=d.$AX;var e=function(a){var b={};return function(c){b[c]||(b[c]=a+c.charAt(0).toUpperCase()+c.substr(1));return b[c]}};b.setter=e("set"),b.getter=e("get"),b.eventHandler=e("on"),b.hasClass=function(a,b){return(" "+a.className+" ").indexOf(" "+b+" ")>=0};var f=function(a,b){var c=[];for(var d=0;d<a.length;d++){var e=a.charAt(d);e.match(/[A-Z]/)&&d>0?c.push(b,e.toLowerCase()):e.match(/[_.\s]/)?c.push(b):c.push(e.toLowerCase())}return c.join("")};b.hyphenate=function(a){return f(a,"-")},b.underscore=function(a){return f(a,"_")},b.onload=d.onload,b._getProp=function(a,b,c){var d=c||window;for(var e=0,f;d&&(f=a[e]);e++)d=f in d?d[f]:b?d[f]={}:undefined;return d},b.getObject=function(a,c,d){return b._getProp(a.split("."),c,d)},b.trim=String.prototype.trim?function(a){return a.trim()}:function(a){return a.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},b.createStylesheet=function(a){var b=document.createElement("style");document.getElementsByTagName("head")[0].appendChild(b),b.styleSheet?b.styleSheet.cssText=a:b.appendChild(document.createTextNode(a));return b}}}),require.define({validate:function(a,b,c){function h(a,b){return"("+(b?"?:":"")+a+")"}function g(a,b,c){if(!(a instanceof Array))return b(a);var d=[];for(var e=0;e<a.length;e++)d.push(b(a[e]));return h(d.join("|"),c)}function f(a,b){return a.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,function(a){if(b&&b.indexOf(a)!=-1)return a;return"\\"+a})}function e(a){a=typeof a=="object"?a:{},typeof a.format=="undefined"&&(a.format="###-###-####");var b=function(a){return f(a,"?").replace(/\?/g,"\\d?").replace(/#/g,"\\d")};return g(a.format,b)}function d(a,b){var c=new RegExp("^"+e(b)+"$","i");return c.test(a)}__DEV__=0;var i="(?:[\\da-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)",j="(?:[a-zA-Z](?:[-\\da-zA-Z]{0,6}[\\da-zA-Z])?)",k="((?:"+i+"\\.)+"+j+"\\.?)",l="([!#-'*+\\-\\/-9=?A-Z^-~]+[.])*[!#-'*+\\-\\/-9=?A-Z^-~]+",m=l+"@"+k,n=g([!0,!1],function(a){if(a)return"(https?|ftps?)\\://";return""}),o="(/(?:[^?#\\s/]+/)*(?:[^?#\\s/]+(?:\\?[^?#\\s/]*)?(?:#[A-Za-z][\\w.:-]*)?)?)?",p,q;b.isEmail=function(a){return(p||(p=new RegExp("^"+m+"$","i"))).test(a)},b.isZipCode=function(a){return d(a,{format:["#####-####","##### ####","#########","#####"]})},b.isUSPhone=function(a){return d(a,{format:["###-###-####","(###) ###-####","(###) ### ####","###.###.####","###/###-####","### ### ####","###-###-#### x#???","(###) ###-#### x#???","(###) ### #### x#???","###.###.#### x#???","###/###-#### x#???","### ### #### x#???","##########"]})},b.isUrl=function(a){return(q||(q=new RegExp("^"+(n+k+o)+"$","i"))).test(a)}}}),require.define({view:function(a,b,c){function v(a){a.owner=a.owner||this}function u(a){a.extend=a.extend||x,a.members=a.members||{},console.log("view.createClass is deprecated: please fix "+a.name);var b=e.createClass(a);return b}function t(){while(r.length)g.alterClass(r.shift(),"touched",!1)}function s(a){r.push(a),setTimeout(t,20)}__DEV__=0;var d=a("util"),e=a("javelin/core"),f=a("javelin/stratcom"),g=a("javelin/dom"),h=a("builder"),i=a("JX"),j=a("binding").Binding,k=b.hasTouch="ontouchstart"in window,l=b.touchEvents={TOUCHSTART:k?"touchstart":"mousedown",TOUCHEND:k?"touchend":"mouseup",TOUCHMOVE:k?"touchmove":"mousemove"},m=1,n=["click","mouseover","mouseout","mousedown","mouseup","keypress","keydown","keyup","focus","blur","change","mousemove","touchstart","touchend","touchmove","touchcancel"],o=" "+n.join(" ")+" ",p,q=30,r=[];f.listen([l.TOUCHSTART],"touchable",function(a){var b=a.getRawEvent();if(!b.button){b=b.touches?b.touches[0]:b;var c=a.getNodes().touchable;p&&s(c),p={x:b.pageX,y:b.pageY,target:c},g.alterClass(c,"touched",!0)}}),f.listen([l.TOUCHMOVE],"touchable",function(a){if(p){var b=a.getRawEvent();b=b.touches?b.touches[0]:b;var c=p.x-b.pageX,d=p.y-b.pageY;Math.sqrt(c*c+d*d)>q&&s(p.target)}}),f.listen([l.TOUCHEND,"mouseout"],"touchable",function(a){p=null,s(a.getNodes().touchable)});var w=["owner","childViews"],x=e.createClass({name:"View",declare:function(){return{}},construct:function(a){var b=d.clone(this.declare(a));b.childViews&&d.forEach(b.childViews,v,this),this.options=d.extend(b,a||{}),this.options.owner=this.options.owner||this,this._modes={},this._tokens={},this.refs={},this.createDom(this.options),this.render(this.options),this.setup(this.options),this.ready&&this.ready(),f.mergeData(0,{})},properties:{node:null,width:null,height:null,tagName:"div",parentView:null,owner:null,model:null,boxOrientation:null,flex:null,metadata:null},delegateProperties:{node:["className","id","innerHTML","tabIndex","title","href","src","type","target","rows","cols","data-ref","cellspacing","cellpadding",{alias:"content",name:"innerHTML"}]},members:{wantsHardwareAcceleration:!1,setup:function(a){for(var b=0;b<w.length;b++){var c=w[b];this.options.hasOwnProperty(c)&&this[d.setter(c)](this.options[c])}for(var e in this.options){if(w.indexOf(e)!==-1)continue;var f=d.setter(e),g=d.getter(e),h=this.options[e],i=" "+(this.getEvents()||[]).join(" ")+" ";if(e.indexOf("on")===0&&i.indexOf(" "+e.substring(2)+" ")>-1)this.listen(e.substring(2),h);else if(h&&h.delegate){var j=this.getOwner(),k=h.filter,l=d.getter(h.delegate),m=d.setter(h.delegate);j[l]=d.bind(function(){return this[g]&&this[g]()},this),j[m]=d.bind(function(a){k&&(a=k.call(this,a)),this[f]&&this[f](a)},this)}else this[f]||(this[f]=d.bind(this.setProperty,this,e)),this[g]||(this[g]=d.bind(this.getProperty,this,e)),this[f](h)}},createDom:function(a){var b=this.getNode();if(b)return b;a.tagName&&this.setTagName(a.tagName),this.setNode(g.$N(this.getTagName())),b=this.getNode(),this.onDocumentInsertion&&b.addEventListener("DOMNodeInsertedIntoDocument",d.bind(this.onDocumentInsertion,this)),this.wantsHardwareAcceleration&&this.addClass("bt-hwa"),this.klass.cssClass&&this.addClass(this.klass.cssClass);return b},setAdditionalClasses:function(a){d.forEach(d.flatten([a]),function(a){this.addClass(a)},this)},render:function(a){},setSigil:function(a){this.getNode().setAttribute("data-sigil",a)},getSigil:function(){return this.getNode.getAttribute("data-sigil")},setBinding:function(a,b,c){this.setModel(a),this.removeBinding(),this._binding=[];var e;d.isArray(b)||(b=[b]);for(var f=0;f<b.length;f++)e=d.extend({},b[f]),c&&(e=d.extend(c,e)),this._binding.push(new j(this,a,d.extend(this.getBindingOptions(),e)))},getBindingOptions:function(){return{}},removeBinding:function(){d.invoke(this._binding||[],"destroy")},setMetadata:function(a){this.setProperty("metadata",a);var b=this.getNode();for(var c in a)b.setAttribute("data-"+c,a[c])},show:function(a){this.getNode().style.display=a||"block"},hide:function(){this.getNode().style.display="none"},addClass:function(a){g.alterClass(this.getNode(),a,!0);return this},removeClass:function(a){g.alterClass(this.getNode(),a,!1);return this},toggleClass:function(a){this.hasClass(a)?this.removeClass(a):this.addClass(a)},hasClass:function(a){var b=new RegExp("\\b"+a+"\\b");return b.test(this.getNode().className)},setMode:function(a,b){this._modes[b]=a;var c=this.getNode(),d=c.className.split(/\s/),e="",f=new RegExp("-"+b+"$");for(var g=0;g<d.length;g++){var h=d[g];f.test(d[g])||(e+=" "+h)}e+=" "+a+"-"+b,c.className=e},getMode:function(a){return this._modes[a]},setBoxOrientation:function(a){this.setProperty("boxOrientation",a),this.addClass("bt-webkit-box"),this.setStyle({webkitBoxOrient:a})},setFlex:function(a){this.setProperty("flex",a),this.setStyle({"-webkit-box-flex":a})},setErrorState:function(a,b){g.alterClass(this.getNode(),"bt-error",b)},setHeight:function(a){this.setProperty("height",a),this.getNode().style.height=a},setWidth:function(a){this.setProperty("width",a),this.getNode().style.width=a},build:function(a,b){return h.build(a,b||this)},setLayout:function(a,b){this.append(this.build(a,b))},getRect:function(){return this.getNode().getBoundingClientRect()},setStyle:function(a){var b=this.getNode().style;if(typeof a=="string")b.cssText+=";"+a;else for(var c in a)b[c]=a[c]},getRef:function(){return this._ref},setRef:function(a){var b=this.getOwner();b&&(b.refs=b.refs||{},b.refs[a]=this),this._ref=a;var c=this.getNode();c.setAttribute("data-ref",this._ref)},findRef:function(a){if(this.refs)return this.refs[a];return null},removeRef:function(a){this.refs&&delete this.refs[a]},refForEvent:function(a){var b=a.getTarget();return this.findContainingRef(b)},findContainingRef:function(a){var b=null;while(a!==this.getNode()){var c=a.getAttribute("data-ref");if(c&&this.refs&&this.refs[c])return this.refs[c];a=a.parentNode}return!1},findPathToParentWithClass:function(a,b){var c=null,d=new RegExp("\\b"+b+"\\b"),e=[];while(a.parentNode&&a.parentNode!=this.getNode()){e.push(a);if(d.test(a.className))return e;a=a.parentNode}return!1},placeIn:function(a,b){b=b||"append";var c=this.getNode();switch(b){case"append":a.appendChild(c);break;case"before":a.parentNode.insertBefore(c,a);break;case"prepend":a.insertBefore(c,a.firstChild);break;default:throw"Invalid node placement: "+b}return this},remove:function(){g.remove(this.getNode())},destroy:function(){d.invoke(this.getChildViews(),"destroy"),d.invoke(this._tokens,"remove");var a=this.getOwner(),b=this.getRef();a&&b&&a.removeRef&&a.removeRef(b),this.remove(),this.isDestroyed=!0},getChildViews:function(){var a=this.getProperty("childViews");a||(a=[],this.setProperty("childViews",a));return a},setChildViews:function(a){d.forEach(this.getChildViews(),this.removeChild,this),d.forEach(h.build(a,this.getOwner()),this.appendChild,this)},removeChild:function(a){this._setParent(a,null),this.setProperty("childViews",d.without(this.getChildViews(),a)),a.destroy(),this.__childrenChanged();return this},append:function(a){d.isArray(a)?d.forEach(a,this.appendChild,this):this.appendChild(a)},appendChild:function(a){this.getChildViews().push(a),this._setParent(a,this),this.__appendChildNode(a),this.__childrenChanged();return this},prependChild:function(a){this.insertChild(a,0)},clearChildren:function(){d.invoke(this.getChildViews(),"destroy"),this.setChildViews([]),this.__childrenChanged()},__appendChildNode:function(a){this.getNode().appendChild(a.getNode())},insertChild:function(a,b){var c=this.getChildViews();typeof b=="undefined"||b===c.length?this.appendChild(a):(b=Math.max(0,Math.min(c.length-1,b)),this._insertAt(a,b));return this},_insertAt:function(a,b){var c=this.getChildViews(),d=c[b];c.splice(b,0,a),this._setParent(a,this),this.__insertNodeBefore(a,d),this.__childrenChanged();return this},__insertNodeBefore:function(a,b){this.getNode().insertBefore(a.getNode(),b.getNode())},__childrenChanged:function(){},_setParent:function(a,b){a.setParentView(b),a.getOwner()||a.setOwner(b?b.getOwner():null)}},beforeCreateClass:function(a){d.forEach(a.delegateProperties,function(b,c){d.forEach(b,function(b){var e=d.getter(c),f=d.setter(b.name||b),g=d.setter(b.alias||b),h=d.getter(b.alias||b),i=d.getter(b.name||b);a.members[g]=function(a){var d=(this.refs?this.refs[c]:null)||this[e]();d[f]?d[f](a):a!==undefined&&(d[b.name||b]=a);return this},a.members[h]=function(){var a=this.findRef(c)||this[e]();return a[i]?a[i]():a[b.name||b]}})}),delete a.delegateProperties;var b=a.extend,c;b?c=a.events.concat(b.prototype[d.getter("events")].call(this)||[]):c=n.concat(a.events||[]),a.events=c,a.members[d.getter("events")]=function(){return c};return a},afterCreateClass:function(a){var c=d.map(this.inheritanceChain,function(a){return"bt-"+d.hyphenate(a.klassName)}).reverse();this.cssClass=c.join(" ");var e=function(a){return o.indexOf(" "+a+" ")<0?"obj:"+a:a},h=function(a){return o.indexOf(" "+a+" ")<0?this.__id__:["id:"+g.uniqID(this.getNode())]};this.prototype.listen=function(a,b){d.isArray(a)||(a=[a]);var c;if(typeof b=="string"){var g=this.getOwner();b=d.bind(g[b],g)}else b=d.bind(b,this);var i=f.listen(d.map(a,e,this),c||d.map(a,h,this),b),j=i.remove,k=this._tokens;i.id=m++,i.remove=function(){delete k[i.id];return j.call(this)},k[i.id]=i;return i},b[this.klassName]=this}});b.View=x,b.Container=x,b.createClass=u}}),require.define({_:function(a,b,c){__DEV__=0,function(){var a=this,b=a._,d={},e=Array.prototype,f=Object.prototype,g=Function.prototype,h=e.slice,i=e.unshift,j=f.toString,k=f.hasOwnProperty,l=e.forEach,m=e.map,n=e.reduce,o=e.reduceRight,p=e.filter,q=e.every,r=e.some,s=e.indexOf,t=e.lastIndexOf,u=Array.isArray,v=Object.keys,w=g.bind,x=function(a){return new C(a)};typeof c!="undefined"&&c.exports?(c.exports=x,x._=x):a._=x,x.VERSION="1.1.6";var y=x.each=x.forEach=function(a,b,c){if(a!=null)if(l&&a.forEach===l)a.forEach(b,c);else if(x.isNumber(a.length)){for(var e=0,f=a.length;e<f;e++)if(b.call(c,a[e],e,a)===d)return}else for(var g in a)if(k.call(a,g)&&b.call(c,a[g],g,a)===d)return};x.map=function(a,b,c){var d=[];if(a==null)return d;if(m&&a.map===m)return a.map(b,c);y(a,function(a,e,f){d[d.length]=b.call(c,a,e,f)});return d},x.reduce=x.foldl=x.inject=function(a,b,c,d){var e=c!==void 0;a==null&&(a=[]);if(n&&a.reduce===n){d&&(b=x.bind(b,d));return e?a.reduce(b,c):a.reduce(b)}y(a,function(a,f,g){!e&&f===0?(c=a,e=!0):c=b.call(d,c,a,f,g)});if(!e)throw new TypeError("Reduce of empty array with no initial value");return c},x.reduceRight=x.foldr=function(a,b,c,d){a==null&&(a=[]);if(o&&a.reduceRight===o){d&&(b=x.bind(b,d));return c!==void 0?a.reduceRight(b,c):a.reduceRight(b)}var e=(x.isArray(a)?a.slice():x.toArray(a)).reverse();return x.reduce(e,b,c,d)},x.find=x.detect=function(a,b,c){var d;z(a,function(a,e,f){if(b.call(c,a,e,f)){d=a;return!0}});return d},x.filter=x.select=function(a,b,c){var d=[];if(a==null)return d;if(p&&a.filter===p)return a.filter(b,c);y(a,function(a,e,f){b.call(c,a,e,f)&&(d[d.length]=a)});return d},x.reject=function(a,b,c){var d=[];if(a==null)return d;y(a,function(a,e,f){b.call(c,a,e,f)||(d[d.length]=a)});return d},x.every=x.all=function(a,b,c){var e=!0;if(a==null)return e;if(q&&a.every===q)return a.every(b,c);y(a,function(a,f,g){if(!(e=e&&b.call(c,a,f,g)))return d});return e};var z=x.some=x.any=function(a,b,c){b||(b=x.identity);var e=!1;if(a==null)return e;if(r&&a.some===r)return a.some(b,c);y(a,function(a,f,g){if(e=b.call(c,a,f,g))return d});return e};x.include=x.contains=function(a,b){var c=!1;if(a==null)return c;if(s&&a.indexOf===s)return a.indexOf(b)!=-1;z(a,function(a){if(c=a===b)return!0});return c},x.invoke=function(a,b){var c=h.call(arguments,2);return x.map(a,function(a){return(b.call?b||a:a[b]).apply(a,c)})},x.pluck=function(a,b){return x.map(a,function(a){return a[b]})},x.max=function(a,b,c){if(!b&&x.isArray(a))return Math.max.apply(Math,a);var d={computed:-Infinity};y(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g>=d.computed&&(d={value:a,computed:g})});return d.value},x.min=function(a,b,c){if(!b&&x.isArray(a))return Math.min.apply(Math,a);var d={computed:Infinity};y(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g<d.computed&&(d={value:a,computed:g})});return d.value},x.sortBy=function(a,b,c){return x.pluck(x.map(a,function(a,d,e){return{value:a,criteria:b.call(c,a,d,e)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;return c<d?-1:c>d?1:0}),"value")},x.sortedIndex=function(a,b,c){c||(c=x.identity);var d=0,e=a.length;while(d<e){var f=d+e>>1;c(a[f])<c(b)?d=f+1:e=f}return d},x.toArray=function(a){if(!a)return[];if(a.toArray)return a.toArray();if(x.isArray(a))return a;if(x.isArguments(a))return h.call(a);return x.values(a)},x.size=function(a){return x.toArray(a).length},x.first=x.head=function(a,b,c){return b!=null&&!c?h.call(a,0,b):a[0]},x.rest=x.tail=function(a,b,c){return h.call(a,b==null||c?1:b)},x.last=function(a){return a[a.length-1]},x.compact=function(a){return x.filter(a,function(a){return!!a})},x.flatten=function(a){return x.reduce(a,function(a,b){if(x.isArray(b))return a.concat(x.flatten(b));a[a.length]=b;return a},[])},x.without=function(a){var b=h.call(arguments,1);return x.filter(a,function(a){return!x.include(b,a)})},x.uniq=x.unique=function(a,b){return x.reduce(a,function(a,c,d){if(0==d||(b===!0?x.last(a)!=c:!x.include(a,c)))a[a.length]=c;return a},[])},x.intersect=function(a){var b=h.call(arguments,1);return x.filter(x.uniq(a),function(a){return x.every(b,function(b){return x.indexOf(b,a)>=0})})},x.zip=function(){var a=h.call(arguments),b=x.max(x.pluck(a,"length")),c=Array(b);for(var d=0;d<b;d++)c[d]=x.pluck(a,""+d);return c},x.indexOf=function(a,b,c){if(a==null)return-1;var d,e;if(c){d=x.sortedIndex(a,b);return a[d]===b?d:-1}if(s&&a.indexOf===s)return a.indexOf(b);for(d=0,e=a.length;d<e;d++)if(a[d]===b)return d;return-1},x.lastIndexOf=function(a,b){if(a==null)return-1;if(t&&a.lastIndexOf===t)return a.lastIndexOf(b);var c=a.length;while(c--)if(a[c]===b)return c;return-1},x.range=function(a,b,c){arguments.length<=1&&(b=a||0,a=0),c=arguments[2]||1;var d=Math.max(Math.ceil((b-a)/c),0),e=0,f=Array(d);while(e<d)f[e++]=a,a+=c;return f},x.bind=function(a,b){if(a.bind===w&&w)return w.apply(a,h.call(arguments,1));var c=h.call(arguments,2);return function(){return a.apply(b,c.concat(h.call(arguments)))}},x.bindAll=function(a){var b=h.call(arguments,1);b.length==0&&(b=x.functions(a)),y(b,function(b){a[b]=x.bind(a[b],a)});return a},x.memoize=function(a,b){var c={};b||(b=x.identity);return function(){var d=b.apply(this,arguments);return k.call(c,d)?c[d]:c[d]=a.apply(this,arguments)}},x.delay=function(a,b){var c=h.call(arguments,2);return setTimeout(function(){return a.apply(a,c)},b)},x.defer=function(a){return x.delay.apply(x,[a,1].concat(h.call(arguments,1)))};var A=function(a,b,c){var d;return function(){var e=this,f=arguments,g=function(){d=null,a.apply(e,f)};c&&clearTimeout(d);if(c||!d)d=setTimeout(g,b)}};x.throttle=function(a,b){return A(a,b,!1)},x.debounce=function(a,b){return A(a,b,!0)},x.once=function(a){var b=!1,c;return function(){if(b)return c;b=!0;return c=a.apply(this,arguments)}},x.wrap=function(a,b){return function(){var c=[a].concat(h.call(arguments));return b.apply(this,c)}},x.compose=function(){var a=h.call(arguments);return function(){var b=h.call(arguments);for(var c=a.length-1;c>=0;c--)b=[a[c].apply(this,b)];return b[0]}},x.after=function(a,b){return function(){if(--a<1)return b.apply(this,arguments)}},x.keys=v||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[];for(var c in a)k.call(a,c)&&(b[b.length]=c);return b},x.values=function(a){return x.map(a,x.identity)},x.functions=x.methods=function(a){return x.filter(x.keys(a),function(b){return x.isFunction(a[b])}).sort()},x.extend=function(a){y(h.call(arguments,1),function(b){for(var c in b)b[c]!==void 0&&(a[c]=b[c])});return a},x.defaults=function(a){y(h.call(arguments,1),function(b){for(var c in b)a[c]==null&&(a[c]=b[c])});return a},x.clone=function(a){return x.isArray(a)?a.slice():x.extend({},a)},x.tap=function(a,b){b(a);return a},x.isEqual=function(a,b){if(a===b)return!0;var c=typeof a,d=typeof b;if(c!=d)return!1;if(a==b)return!0;if(!a&&b||a&&!b)return!1;a._chain&&(a=a._wrapped),b._chain&&(b=b._wrapped);if(a.isEqual)return a.isEqual(b);if(x.isDate(a)&&x.isDate(b))return a.getTime()===b.getTime();if(x.isNaN(a)&&x.isNaN(b))return!1;if(x.isRegExp(a)&&x.isRegExp(b))return a.source===b.source&&a.global===b.global&&a.ignoreCase===b.ignoreCase&&a.multiline===b.multiline;if(c!=="object")return!1;if(a.length&&a.length!==b.length)return!1;var e=x.keys(a),f=x.keys(b);if(e.length!=f.length)return!1;for(var g in a)if(!(g in b)||!x.isEqual(a[g],b[g]))return!1;return!0},x.isEmpty=function(a){if(x.isArray(a)||x.isString(a))return a.length===0;for(var b in a)if(k.call(a,b))return!1;return!0},x.isElement=function(a){return!!a&&a.nodeType==1},x.isArray=u||function(a){return j.call(a)==="[object Array]"},x.isArguments=function(a){return!!a&&!!k.call(a,"callee")},x.isFunction=function(a){return!!(a&&a.constructor&&a.call&&a.apply)},x.isString=function(a){return!!(a===""||a&&a.charCodeAt&&a.substr)},x.isNumber=function(a){return!!(a===0||a&&a.toExponential&&a.toFixed)},x.isNaN=function(a){return a!==a},x.isBoolean=function(a){return a===!0||a===!1},x.isDate=function(a){return!!(a&&a.getTimezoneOffset&&a.setUTCFullYear)},x.isRegExp=function(a){return!(!(a&&a.test&&a.exec)||!a.ignoreCase&&a.ignoreCase!==!1)},x.isNull=function(a){return a===null},x.isUndefined=function(a){return a===void 0},x.noConflict=function(){a._=b;return this},x.identity=function(a){return a},x.times=function(a,b,c){for(var d=0;d<a;d++)b.call(c,d)},x.mixin=function(a){y(x.functions(a),function(b){E(b,x[b]=a[b])})};var B=0;x.uniqueId=function(a){var b=B++;return a?a+b:b},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g},x.template=function(a,b){var c=x.templateSettings,d="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+a.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(c.interpolate,function(a,b){return"',"+b.replace(/\\'/g,"'")+",'"}).replace(c.evaluate||null,function(a,b){return"');"+b.replace(/\\'/g,"'").replace(/[\r\n\t]/g," ")+"__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');",e=new Function("obj",d);return b?e(b):e};var C=function(a){this._wrapped=a};x.prototype=C.prototype;var D=function(a,b){return b?x(a).chain():a},E=function(a,b){C.prototype[a]=function(){var a=h.call(arguments);i.call(a,this._wrapped);return D(b.apply(x,a),this._chain)}};x.mixin(x),y(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=e[a];C.prototype[a]=function(){b.apply(this._wrapped,arguments);return D(this._wrapped,this._chain)}}),y(["concat","join","slice"],function(a){var b=e[a];C.prototype[a]=function(){return D(b.apply(this._wrapped,arguments),this._chain)}}),C.prototype.chain=function(){this._chain=!0;return this},C.prototype.value=function(){return this._wrapped}}()}}),require.define({JX:function(require,exports,module){__DEV__=0;if(window.JX)JX.copy(exports,JX);else{(function(){function b(b){JX[b]||(a[b]=[],JX[b]=function(){a[b].push(arguments)})}if(window.JX)JX.copy(exports,JX);else{window.JX=exports;var a={};JX.flushHoldingQueue=function(b,c){for(var d=0;d<a[b].length;d++)c.apply(null,a[b][d]);a[b]={}},b("install"),b("behavior"),b("install-init"),window.__DEV__=window.__DEV__||0;var c=!1,d=[],e=[],f=document.documentElement,g=!!f.addEventListener;JX.__rawEventQueue=function(a){e.push(a);var b=JX.Stratcom;if(b&&b.ready){var f=e;e=[];for(var g=0;g<f.length;++g){var h=f[g];try{var i=h.type}catch(j){continue}if(!c&&h.type=="domready"){document.body&&(document.body.id=null),c=!0;for(var g=0;g<d.length;g++)d[g]()}b.dispatch(h)}}else{var k=a.srcElement||a.target;if(k&&a.type in{click:1,submit:1}&&k.getAttribute&&k.getAttribute("data-mustcapture")==="1"){a.returnValue=!1,a.preventDefault&&a.preventDefault(),document.body.id="event_capture",!add_event_listener&&document.createEventObject&&(e.pop(),e.push(document.createEventObject(a)));return!1}}},JX.enableDispatch=function(a,b){__DEV__&&(JX.__allowedEvents[b]=!0),a.addEventListener?a.addEventListener(b,JX.__rawEventQueue,!0):a.attachEvent&&a.attachEvent("on"+b,JX.__rawEventQueue)};var h=["click","change","keypress","mousedown","mouseover","mouseout","mouseup","keyup","keydown","drop","dragenter","dragleave","dragover","touchstart","touchmove","touchend","touchcancel"];g||h.push("focusin","focusout"),window.opera?h.push("focus","blur"):h.push("submit"),__DEV__&&(JX.__allowedEvents={},"onpagehide"in window&&(JX.__allowedEvents.unload=!0));for(var i=0;i<h.length;++i)JX.enableDispatch(f,h[i]);var j=["onpagehide"in window?"pagehide":"unload","resize","focus","blur"];for(var i=0;i<j.length;++i)JX.enableDispatch(window,j[i]);JX.__simulate=function(a,b){if(!g){var c={target:a,type:b};JX.__rawEventQueue(c);if(c.returnValue===!1)return!1}};if(g)document.addEventListener("DOMContentLoaded",function(){JX.__rawEventQueue({type:"domready"})},!0);else{var k="if (this.readyState == 'complete') {JX.__rawEventQueue({type: 'domready'});}";document.write('<script defer="defer" src="javascript:void(0)" onreadystatechange="'+k+'"'+"></sc"+"ript>")}JX.onload=function(a){c?a():d.push(a)}}})(),JX.$A=function(a){var b=[];for(var c=0;c<a.length;c++)b.push(a[c]);return b},JX.$AX=function(a){return a instanceof Array?a:[a]},JX.copy=function(a,b){for(var c in b)a[c]=b[c];return a},JX.bind=function(a,b,c){if(__DEV__&&typeof b!="function")throw new Error("JX.bind(context, <yuck>, ...): Attempting to bind something that is not a function.");var d=JX.$A(arguments).slice(2);return function(){return b.apply(a||window,d.concat(JX.$A(arguments)))}},JX.bag=function(){},JX.keys=function(a){var b=[];for(var c in a)b.push(c);return b},JX.defer=function(a,b){var c=setTimeout(a,b||0);return{stop:function(){clearTimeout(c)}}},JX.id=function(a){return a};if(__DEV__){if(!window.console||!window.console.log)window.opera&&window.opera.postError?window.console={log:function(a){window.opera.postError(a)}}:window.console={log:function(a){}};JX.log=function(a){window.console.log(a)},window.alert=function(a){var b=[],c=!1;return function(d){c?JX.log("alert(...): discarded reentrant alert."):(c=!0,b.push((new Date).getTime()),b.length>3&&b.splice(0,b.length-3),b.length>=3&&b[b.length-1]-b[0]<5e3?confirm(d+"\n\nLots of alert()s recently. Kill them?")&&(window.alert=JX.bag):a(d),c=!1)}}(window.alert)}JX.install=function(a,b){typeof JX.install._nextObjectID=="undefined"&&(JX.install._nextObjectID=0);if(a in JX){if(__DEV__)throw new Error('JX.install("'+a+'", ...): '+"trying to reinstall something that has already been installed.")}else{if(__DEV__&&"name"in b)throw new Error('JX.install("'+a+'", {"name": ...}): '+'trying to install with "name" property.'+"Either remove it or call JX.createClass directly.");JX.install._queue||(JX.install._queue=[]),JX.install._queue.push([a,b]);do{var c,d=null,e;for(var f=0;f<JX.install._queue.length;++f){c=JX.install._queue[f][1];if(c.extend&&!JX[c.extend])continue;d=JX.install._queue.splice(f,1)[0][0],--f,c.extend&&(c.extend=JX[c.extend]),e=c.initialize,delete c.initialize,c.name="JX."+d,JX[d]=JX.createClass(c),e&&(JX.Stratcom&&JX.Stratcom.ready?e.apply(null):JX["install-init"](e))}}while(d)}},JX.createClass=function(a){typeof JX.install._nextObjectID=="undefined"&&(JX.install._nextObjectID=0);var b=a.name||"";if(__DEV__){var c={construct:1,statics:1,members:1,extend:1,properties:1,events:1,name:1};for(var d in a)if(!(d in c))throw new Error('JX.createClass("'+b+'", {"'+d+'": ...}): '+"trying to create unknown property `"+d+"`.");if(a.constructor!=={}.constructor)throw new Error('JX.createClass("'+b+'", {"constructor": ...}): '+"property `constructor` should be called `construct`.")}var e=function(a,b){var c=function(){this.__id__="__obj__"+ ++JX.install._nextObjectID;return(b.construct||b.extend||JX.bag).apply(this,arguments)};if(__DEV__){var d=c;c=function(){if(this==window||this==JX)throw new Error("<"+e.__readable__+">: "+'Tried to construct an instance without the "new" operator.');return d.apply(this,arguments)}}return c}(b,a);e.__readable__=b;for(var d in a.statics)e[d]=a.statics[d];var f;if(a.extend){var g=function(){};g.prototype=a.extend.prototype,f=e.prototype=new g}else f=e.prototype={};f.__class__=e;for(var d in a.properties||{}){var h=d.charAt(0).toUpperCase()+d.substr(1),i="__auto__"+d;f[i]=a.properties[d],f["set"+h]=function(a){return function(b){this[a]=b;return this}}(i),f["get"+h]=function(a){return function(){return this[a]}}(i)}if(__DEV__)for(var j in a.members){if(a.extend&&j[0]=="_")throw new Error('JX.createClass("'+b+'", ...): '+'installed member "'+j+'" must not be named with '+"a leading underscore because it is in a subclass. Variables "+"are analyzed and crushed one file at a time, and crushed "+"member variables in subclasses alias crushed member variables "+"in superclasses. Remove the underscore, refactor the class so "+"it does not extend anything, or fix the minifier to be "+"capable of safely crushing subclasses.");var k=a.members[j];if(typeof k=="object"&&k!==null)throw new Error('JX.createClass("'+b+'", ...): '+'installed member "'+j+'" is not a scalar or '+"function. Prototypal inheritance in Javascript aliases object "+"references across instances so all instances are initialized "+"to point at the exact same object. This is almost certainly "+"not what you intended. Make this member static to share it "+"across instances, or initialize it in the constructor to "+"prevent reference aliasing and give each instance its own "+"copy of the value.")}for(var d in a.members)f[d]=a.members[d];var l=a.extend||{},m=l.__events__,n=a.events||[],o=m||n.length;if(o){var p={};if(__DEV__){for(var q in m||{})p[q]=!0;for(var r=0;r<n.length;++r)p[a.events[r]]=!0}e.__events__=p,e.__name__="class:"+b;var s=l.__path__||[];e.__path__=s.concat([e.__name__]),f.invoke=function(a){if(__DEV__&&!(a in this.__class__.__events__))throw new Error(this.__class__.__readable__+'.invoke("'+a+'", ...): '+"invalid event type. Valid event types are: "+JX.keys(this.__class__.__events__).join(", ")+".");return JX.Stratcom.invoke("obj:"+a,this.__class__.__path__.concat([this.__id__]),{args:JX.$A(arguments).slice(1)})},f.listen=function(a,b){if(__DEV__&&!(a in this.__class__.__events__))throw new Error(this.__class__.__readable__+'.listen("'+a+'", ...): '+"invalid event type. Valid event types are: "+JX.keys(this.__class__.__events__).join(", ")+".");return JX.Stratcom.listen("obj:"+a,this.__id__,JX.bind(this,function(a){return b.apply(this,a.getData().args)}))},e.listen=function(a,b){if(__DEV__&&!(a in this.__events__))throw new Error(this.__readable__+'.listen("'+a+'", ...): '+"invalid event type. Valid event types are: "+JX.keys(this.__events__).join(", ")+".");return JX.Stratcom.listen("obj:"+a,this.__name__,JX.bind(this,function(a){return b.apply(this,a.getData().args)}))}}else if(__DEV__){var t='class does not define any events. Pass an "events" property to JX.createClass() to define events.';e.listen=e.listen||function(){throw new Error(this.__readable__+".listen(...): "+t)},e.invoke=e.invoke||function(){throw new Error(this.__readable__+".invoke(...): "+t)},f.listen=f.listen||function(){throw new Error(this.__class__.__readable__+".listen(...): "+t)},f.invoke=f.invoke||function(){throw new Error(this.__class__.__readable__+".invoke(...): "+t)}}return e},JX.flushHoldingQueue("install",JX.install),JX.install("Event",{members:{stop:function(){var a=this.getRawEvent();a&&(a.cancelBubble=!0,a.stopPropagation&&a.stopPropagation()),this.setStopped(!0);return this},prevent:function(){var a=this.getRawEvent();a&&(a.returnValue=!1,a.preventDefault&&a.preventDefault()),this.setPrevented(!0);return this},kill:function(){this.prevent(),this.stop();return this},getSpecialKey:function(){var a=this.getRawEvent();if(!a||a.shiftKey)return null;return JX.Event._keymap[a.keyCode]||null},isRightButton:function(){var a=this.getRawEvent();return a.which==3||a.button==2},getNode:function(a){return this.getNodes()[a]||null},getNodeData:function(a){return JX.Stratcom.getData(this.getNode(a))}},statics:{_keymap:{8:"delete",9:"tab",13:"return",27:"esc",37:"left",38:"up",39:"right",40:"down",63232:"up",63233:"down",62234:"left",62235:"right"}},properties:{rawEvent:null,type:null,target:null,data:null,path:[],stopped:!1,prevented:!1,nodes:{}},initialize:function(){__DEV__&&(JX.Event.prototype.toString=function(){var a="["+this.getPath().join(", ")+"]";return"Event<"+this.getType()+", "+a+", "+this.getTarget()+">"})}}),JX.install("Stratcom",{statics:{ready:!1,_targets:{},_handlers:[],_need:{},_auto:"*",_data:{},_execContext:[],_typeMap:{focusin:"focus",focusout:"blur"},_dataBlock:2,_dataIndex:0,invoke:function(a,b,c){var d=(new JX.Event).setType(a).setData(c||{}).setPath(b||[]);return this._dispatchProxy(d)},listen:function(a,b,c){if(__DEV__){if(arguments.length==4)throw new Error("JX.Stratcom.listen(...): requires exactly 3 arguments. Did you mean JX.DOM.listen?");if(arguments.length!=3)throw new Error("JX.Stratcom.listen(...): requires exactly 3 arguments.");if(typeof c!="function")throw new Error("JX.Stratcom.listen(...): callback is not a function.")}var d=[];a=JX.$AX(a),b||(b=this._auto),b instanceof Array?b[0]instanceof Array||(b=[b]):b=[[b]];for(var e=0;e<a.length;++e){var f=a[e];"onpagehide"in window&&f=="unload"&&(f="pagehide"),f in this._targets||(this._targets[f]={});var g=this._targets[f];for(var h=0;h<b.length;++h){var i=b[h],j=this._handlers.length;this._handlers.push(c),this._need[j]=i.length,d.push(j);for(var k=0;k<i.length;++k){if(__DEV__){if(i[k]=="tag:#document")throw new Error('JX.Stratcom.listen(..., "tag:#document", ...): listen for all events using null, not "tag:#document"');if(i[k]=="tag:window")throw new Error('JX.Stratcom.listen(..., "tag:window", ...): listen for window events using null, not "tag:window"')}g[i[k]]||(g[i[k]]=[]),g[i[k]].push(j)}}}return{remove:function(){for(var a=0;a<d.length;a++)delete JX.Stratcom._handlers[d[a]]}}},dispatch:function(a){var b=[],c={},d=function(a,d){c.hasOwnProperty(a)||(c[a]=d,b.push(a))},e=a.srcElement||a.target;e&&e.nodeType===3&&(e=e.parentNode);if(!e||!e.getAttribute)e=null;var f=e;while(f&&f.getAttribute){d("tag:"+f.nodeName.toLowerCase(),f);var g=f.id;g&&d("id:"+g,f);var h=f.getAttribute("data-sigil");if(h){h=h.split(" ");for(var i=0;i<h.length;i++)d(h[i],f)}f=f.parentNode}var j=a.type;j in this._typeMap&&(j=this._typeMap[j]);var k=(new JX.Event).setRawEvent(a).setType(j).setTarget(e).setNodes(c).setPath(b.reverse());return this._dispatchProxy(k)},_dispatchProxy:function(a){var b=this._targets[a.getType()];if(!b)return a;var c=a.getPath(),d=c.length,e={},f;for(var g=-1;g<d;++g){g==-1?f=b[this._auto]:f=b[c[g]];if(!f)continue;for(var h=0;h<f.length;++h)e[f[h]]=(e[f[h]]||0)+1}var i=[];for(var j in e)if(e[j]==this._need[j]){var k=this._handlers[j];k&&i.push(k)}this._execContext.push({handlers:i,event:a,cursor:0}),this.pass(),this._execContext.pop();return a},pass:function(){var a=this._execContext[this._execContext.length-1];while(a.cursor<a.handlers.length){var b=a.cursor;++a.cursor,(a.handlers[b]||JX.bag)(a.event);if(a.event.getStopped())break}return a.event.getStopped()||a.event.getPrevented()},context:function(){var a=this._execContext.length;if(!a)return null;return this._execContext[a-1].event},mergeData:function(a,b){this._data[a]=b,a==0&&(JX.Stratcom.ready=!0,JX.flushHoldingQueue("install-init",function(a){a()}),JX.__rawEventQueue({type:"start-queue"}))},hasSigil:function(a,b){if(__DEV__)if(!a||!a.getAttribute)throw new Error("JX.Stratcom.hasSigil(<non-element>, ...): node is not an element. Most likely, you're passing window or document, which are not elements and can't have sigils.");var c=a.getAttribute("data-sigil")||!1;return c&&(" "+c+" ").indexOf(" "+b+" ")>-1},addSigil:function(a,b){if(__DEV__)if(!a||!a.getAttribute)throw new Error("JX.Stratcom.addSigil(<non-element>, ...): node is not an element. Most likely, you're passing window or document, which are not elements and can't have sigils.");var c=a.getAttribute("data-sigil");c&&!JX.Stratcom.hasSigil(a,b)&&(b=c+" "+b),a.setAttribute("data-sigil",b)},getData:function(a){if(__DEV__)if(!a||!a.getAttribute)throw new Error("JX.Stratcom.getData(<non-element>): node is not an element. Most likely, you're passing window or document, which are not elements and can't have data.");var b=(a.getAttribute("data-meta")||"").split("_");if(b[0]&&b[1]){var c=this._data[b[0]],d=b[1];if(c&&d in c)return c[d]}var e={};this._data[1]||(this._data[1]={}),this._data[1][this._dataIndex]=e,a.setAttribute("data-meta","1_"+this._dataIndex++);return e},addData:function(a,b){if(__DEV__){if(!a||!a.getAttribute)throw new Error("JX.Stratcom.addData(<non-element>, ...): node is not an element. Most likely, you're passing window or document, which are not elements and can't have sigils.");if(!b||typeof b!="object")throw new Error("JX.Stratcom.addData(..., <nonobject>): data to attach to node is not an object. You must use objects, not primitives, for metadata.")}return JX.copy(JX.Stratcom.getData(a),b)},allocateMetadataBlock:function(){return this._dataBlock++}}}),JX.behavior=function(a,b){if(__DEV__){if(JX.behavior._behaviors.hasOwnProperty(a))throw new Error('JX.behavior("'+a+'", ...): '+"behavior is already registered.");if(!b)throw new Error('JX.behavior("'+a+'", <nothing>): '+"initialization function is required.");if(typeof b!="function")throw new Error('JX.behavior("'+a+'", <garbage>): '+"initialization function is not a function.")}JX.behavior._behaviors[a]=b},JX.initBehaviors=function(a){for(var b in a){if(__DEV__&&!(b in JX.behavior._behaviors))throw new Error('JX.initBehavior("'+b+'", ...): '+"behavior is not registered.");var c=a[b];if(!c.length){if(JX.behavior._initialized.hasOwnProperty(b))continue;c=[null]}for(var d=0;d<c.length;d++)JX.behavior._behaviors[b](c[d]);JX.behavior._initialized[b]=!0}},!function(a){a.behavior._behaviors={},a.behavior._initialized={},a.flushHoldingQueue("behavior",a.behavior)}(JX),JX.install("Request",{construct:function(a,b){this.setURI(a),b&&this.listen("done",b)},events:["send","done","error","finally"],members:{_xhrkey:null,_transport:null,_finished:!1,_block:null,send:function(){var a=null;try{try{a=new XMLHttpRequest}catch(b){a=new ActiveXObject("Msxml2.XMLHTTP")}}catch(b){a=new ActiveXObject("Microsoft.XMLHTTP")}this._transport=a,this._xhrkey=JX.Request._xhr.length,JX.Request._xhr.push(this),a.onreadystatechange=JX.bind(this,this._onreadystatechange);var c=this.getData()||{};c.__ajax__=!0,this._block=JX.Stratcom.allocateMetadataBlock(),c.__metablock__=this._block;var d=(this.getDataSerializer()||JX.Request.defaultDataSerializer)(c),e=this.getURI(),f=this.getMethod().toUpperCase();f=="GET"&&(e+=(e.indexOf("?")===-1?"?":"&")+d),this.invoke("send",this),this.getTimeout()&&(this._timer=JX.defer(JX.bind(this,this._fail,JX.Request.ERROR_TIMEOUT),this.getTimeout())),a.open(f,e,!0);if(__DEV__&&this.getFile()){if(f!="POST")throw new Error("JX.Request.send(): attempting to send a file over GET. You must use POST.");if(this.getData())throw new Error("JX.Request.send(): attempting to send data and a file. You can not send both at once.")}f=="POST"?this.getFile()?a.send(this.getFile()):(a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.send(d)):a.send(null)},abort:function(){this._cleanup()},_onreadystatechange:function(){var xport=this._transport;try{if(this._finished)return;if(xport.readyState!=4)return;if(xport.status!==0&&(xport.status<200||xport.status>=300)){this._fail();return}if(__DEV__){if(!xport.responseText.length)throw new Error('JX.Request("'+this.getURI()+'", ...): '+"server returned an empty response.");if(xport.responseText.indexOf("for (;;);")!=0)throw new Error('JX.Request("'+this.getURI()+'", ...): '+"server returned an invalid response.")}var text=xport.responseText.substring("for (;;);".length),response=eval("("+text+")")}catch(exception){__DEV__&&JX.log('JX.Request("'+this.getURI()+'", ...): '+"caught exception processing response: "+exception),this._fail();return}try{response.error?this._fail(response.error):(JX.Stratcom.mergeData(this._block,response.javelin_metadata||{}),this._done(response),JX.initBehaviors(response.javelin_behaviors||{}))}catch(exception){JX.defer(function(){throw exception})}},_fail:function(a){this._cleanup(),this.invoke("error",a,this),this.invoke("finally")},_done:function(a){this._cleanup();if(a.onload)for(var b=0;b<a.onload.length;b++)(new Function(a.onload[b]))();this.invoke("done",this.getRaw()?a:a.payload,this),this.invoke("finally")},_cleanup:function(){this._finished=!0,delete JX.Request._xhr[this._xhrkey],this._timer&&this._timer.stop(),this._transport.abort()}},statics:{_xhr:[],shutdown:function(){for(var a=0;a<JX.Request._xhr.length;a++)try{JX.Request._xhr[a]&&JX.Request._xhr[a].abort()}catch(b){}JX.Request._xhr=[]},ERROR_TIMEOUT:-9e3,defaultDataSerializer:function(a){var b=[];for(var c in a)b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b.join("&")}},properties:{URI:null,data:null,dataSerializer:null,method:"POST",file:null,raw:!1,timeout:null},initialize:function(){JX.Stratcom.listen("unload",null,JX.Request.shutdown)}}),JX.$V=function(a,b){return new JX.Vector(a,b)},JX.install("Vector",{construct:function(a,b){if(typeof b=="undefined")return JX.Vector.getPos(a);this.x=parseFloat(a),this.y=parseFloat(b)},members:{x:null,y:null,setPos:function(a){a.style.left=this.x===null?"":parseInt(this.x,10)+"px",a.style.top=this.y===null?"":parseInt(this.y,10)+"px";return this},setDim:function(a){a.style.width=this.x===null?"":parseInt(this.x,10)+"px",a.style.height=this.y===null?"":parseInt(this.y,10)+"px";return this},add:function(a,b){if(a instanceof JX.Vector)return this.add(a.x,a.y);return new JX.Vector(this.x+parseFloat(a),this.y+parseFloat(b))}},statics:{_viewport:null,getPos:function(a){JX.Event&&a instanceof JX.Event&&(a=a.getRawEvent());if("pageX"in a||"clientX"in a){var b=JX.Vector._viewport;return new JX.Vector(a.pageX||a.clientX+b.scrollLeft,a.pageY||a.clientY+b.scrollTop)}var c=a.offsetLeft,d=a.offsetTop;while(a.offsetParent&&a.offsetParent!=document.body)a=a.offsetParent,c+=a.offsetLeft,d+=a.offsetTop;return new JX.Vector(c,d)},getDim:function(a){return new JX.Vector(a.offsetWidth,a.offsetHeight)},getScroll:function(){var a=document.body,b=document.documentElement;return new JX.Vector(a.scrollLeft||b.scrollLeft,a.scrollTop||b.scrollTop)},getViewport:function(){var a=JX.Vector._viewport,b=window;return new JX.Vector(b.innerWidth||a.clientWidth||0,b.innerHeight||a.clientHeight||0)},getDocument:function(){var a=JX.Vector._viewport;return new JX.Vector(a.scrollWidth||0,a.scrollHeight||0)}},initialize:function(){var a=(a=document)&&(a=a.documentElement)||(a=document)&&(a=a.body);JX.Vector._viewport=a,__DEV__&&(JX.Vector.prototype.toString=function(){return"<"+this.x+", "+this.y+">"})}}),JX.$=function(a){if(__DEV__&&!a)throw new Error("Empty ID passed to JX.$()!");var b=document.getElementById(a);if(!b||b.id!=a){if(__DEV__&&b&&b.id!=a)throw new Error('JX.$("'+a+'"): '+"document.getElementById() returned an element without the "+"correct ID. This usually means that the element you are trying "+"to select is being masked by a form with the same value in its "+'"name" attribute.');throw JX.$.NotFound}return b},JX.$.NotFound={},__DEV__&&(JX.$.NotFound=new Error("JX.$() or JX.DOM.find() call matched no nodes.")),JX.install("HTML",{construct:function(a){if(__DEV__){var b=["legend","thead","tbody","tfoot","column","colgroup","caption","tr","th","td","option"],c=new RegExp("^\\s*<("+b.join("|")+")\\b","i"),d=null;if(d=a.match(c))throw new Error('new JX.HTML("<'+d[1]+'>..."): '+"call initializes an HTML object with an invalid partial fragment "+"and can not be converted into DOM nodes. The enclosing tag of an "+"HTML content string must be appendable to a document fragment. "+"For example, <table> is allowed but <tr> or <tfoot> are not.");var e=/<script\b/;if(a.match(e))throw new Error('new JX.HTML("...<script>..."): call initializes an HTML object with an embedded script tag! Are you crazy?! Do NOT do this!!!');var f=/<object\b/;if(a.match(f))throw new Error('new JX.HTML("...<object>..."): call initializes an HTML object with an embedded <object> tag. IE will not do the right thing with this.')}this._content=a},members:{_content:null,getFragment:function(){var a=JX.$N("div");a.innerHTML=this._content;var b=document.createDocumentFragment();while(a.firstChild)b.appendChild(a.removeChild(a.firstChild));return b}}}),JX.$H=function(a){return new JX.HTML(a)},JX.$N=function(a,b,c){typeof c=="undefined"&&(typeof b!="object"||b instanceof JX.HTML)&&(c=b,b={});if(__DEV__&&a.toLowerCase()!=a)throw new Error('$N("'+a+'", ...): '+"tag name must be in lower case; "+'use "'+a.toLowerCase()+'", not "'+a+'".');var d=document.createElement(a);b.style&&(JX.copy(d.style,b.style),delete b.style),b.sigil&&(JX.Stratcom.addSigil(d,b.sigil),delete b.sigil),b.meta&&(JX.Stratcom.addData(d,b.meta),delete b.meta);if(__DEV__)if("metadata"in b||"data"in b)throw new Error("$N("+a+", ...): "+'use the key "meta" to specify metadata, not "data" or "metadata".');JX.copy(d,b),c&&JX.DOM.setContent(d,c);return d},JX.install("DOM",{statics:{_autoid:0,_metrics:{},setContent:function(a,b){if(__DEV__&&!JX.DOM.isNode(a))throw new Error("JX.DOM.setContent(<yuck>, ...): first argument must be a DOM node.");while(a.firstChild)JX.DOM.remove(a.firstChild);JX.DOM.appendContent(a,b)},prependContent:function(a,b){if(__DEV__&&!JX.DOM.isNode(a))throw new Error("JX.DOM.prependContent(<junk>, ...): first argument must be a DOM node.");this._insertContent(a,b,this._mechanismPrepend)},appendContent:function(a,b){if(__DEV__&&!JX.DOM.isNode(a))throw new Error("JX.DOM.appendContent(<bleh>, ...): first argument must be a DOM node.");this._insertContent(a,b,this._mechanismAppend)},_mechanismPrepend:function(a,b){a.insertBefore(b,a.firstChild)},_mechanismAppend:function(a,b){a.appendChild(b)},_insertContent:function(a,b,c){if(b!==null&&typeof b!="undefined"){b instanceof JX.HTML&&(b=b.getFragment());if(b instanceof Array)for(var d=0;d<b.length;d++){var e=typeof b[d]=="string"?document.createTextNode(b[d]):b[d];c(a,e)}else b.nodeType?c(a,b):c(a,document.createTextNode(b))}},remove:function(a){a.parentNode&&JX.DOM.replace(a,null);return a},replace:function(a,b){if(__DEV__&&!a.parentNode)throw new Error("JX.DOM.replace(<node>, ...): node has no parent node, so it can not be replaced.");var c;a.nextSibling?c=JX.bind(a.nextSibling,function(a,b){a.insertBefore(b,this)}):c=this._mechanismAppend;var d=a.parentNode;a.parentNode.removeChild(a),this._insertContent(d,b,c);return a},nearest:function(a,b){while(a&&a.getAttribute&&!JX.Stratcom.hasSigil(a,b))a=a.parentNode;return a},serialize:function(a){var b=a.getElementsByTagName("*"),c={};for(var d=0;d<b.length;++d){if(!b[d].name)continue;var e=b[d].type,f=b[d].tagName;if(e in{radio:1,checkbox:1}&&b[d].checked||e in{text:1,hidden:1,password:1}||f in{TEXTAREA:1,SELECT:1})c[b[d].name]=b[d].value}return c},isNode:function(a){return!!a&&!!a.nodeName&&a!==window},isType:function(a,b){a=(""+(a.nodeName||"")).toUpperCase(),b=JX.$AX(b);for(var c=0;c<b.length;++c)if(b[c].toUpperCase()==a)return!0;return!1},listen:function(a,b,c,d){if(__DEV__){var e=JX.$AX(b);for(var f=0;f<e.length;f++){var g=e[f];if(!(g in JX.__allowedEvents))throw new Error('JX.DOM.listen(...): can only listen to events registered in init.js. "'+g+'" not found.')}}var h=["id:"+JX.DOM.uniqID(a)];c=JX.$AX(c||[]);if(!c.length)c=h;else for(var i=0;i<c.length;i++)c[i]=h.concat(JX.$AX(c[i]));return JX.Stratcom.listen(b,c,d)},uniqID:function(a){a.id||(a.id="autoid_"+ ++JX.DOM._autoid);return a.id},alterClass:function(a,b,c){var d=(" "+a.className+" ").indexOf(" "+b+" ")>-1;c&&!d?a.className+=" "+b:d&&!c&&(a.className=a.className.replace(new RegExp("(^|\\s)"+b+"(?:\\s|$)","g")," "))},htmlize:function(a){return(""+a).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},show:function(){if(__DEV__)for(var a=0;a<arguments.length;++a)if(!arguments[a])throw new Error("JX.DOM.show(...): one or more arguments were null or empty.");for(var a=0;a<arguments.length;++a)arguments[a].style.display=""},hide:function(){if(__DEV__)for(var a=0;a<arguments.length;++a)if(!arguments[a])throw new Error("JX.DOM.hide(...): one or more arguments were null or empty.");for(var a=0;a<arguments.length;++a)arguments[a].style.display="none"},textMetrics:function(a,b,c){if(!this._metrics[b]){var d=JX.$N("var",{className:b});this._metrics[b]=d}var e=this._metrics[b];document.body.appendChild(e),e.style.width=c?c+"px":"",JX.DOM.setContent(e,JX.$H(JX.DOM.htmlize(a.value).replace(/\n/g,"<br />")));var f=JX.Vector.getDim(e);document.body.removeChild(e);return f},scry:function(a,b,c){if(__DEV__&&!JX.DOM.isNode(a))throw new Error("JX.DOM.scry(<yuck>, ...): first argument must be a DOM node.");var d=a.getElementsByTagName(b);if(!c)return JX.$A(d);var e=[];for(var f=0;f<d.length;f++)JX.Stratcom.hasSigil(d[f],c)&&e.push(d[f]);return e},find:function(a,b,c){if(__DEV__&&!JX.DOM.isNode(a))throw new Error('JX.DOM.find(<glop>, "'+b+'", "'+c+'"): '+"first argument must be a DOM node.");var d=JX.DOM.scry(a,b,c);if(__DEV__&&d.length>1)throw new Error('JX.DOM.find(<node>, "'+b+'", "'+c+'"): '+"matched more than one node.");if(!d.length)throw JX.$.NotFound;return d[0]},focus:function(a){try{a.focus()}catch(b){}},scrollTo:function(a){window.scrollTo(0,JX.$V(a).y)}}}),JX.install("JSON",{statics:{serialize:function(a){if(!__DEV__)return JX.JSON._val(a);try{return JX.JSON._val(a)}catch(b){JX.log("JX.JSON.serialize(...): caught exception while serializing object. ("+b+")")}},_val:function(a){var b=[];if(a===null)return"null";if(a.push&&a.pop){for(var c=0;c<a.length;c++)typeof a[c]!="undefined"&&b.push(JX.JSON._val(a[c]));return"["+b.join(",")+"]"}if(a===!0)return"true";if(a===!1)return"false";if(typeof a=="string")return JX.JSON._esc(a);if(typeof a=="number")return a;for(var d in a)b.push(JX.JSON._esc(d)+":"+JX.JSON._val(a[d]));return"{"+b.join(",")+"}"},_escexp:/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,_meta:{"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},_esc:function(a){JX.JSON._escexp.lastIndex=0;return JX.JSON._escexp.test(a)?'"'+a.replace(JX.JSON._escexp,JX.JSON._replace)+'"':'"'+a+'"'},_replace:function(a){if(a in JX.JSON._meta)return JX.JSON._meta[a];return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}}})}}}),require.define({"mixins/actionable":function(a,b,c){__DEV__=0;var d=a("view"),e=a("util");b.Actionable={actionableInit:function(){this.setSigil("touchable"),this.listen(d.touchEvents.TOUCHEND,e.bind(this.actionableTouchEnd,this))},actionableTouchEnd:function(a){e.hasClass(this.getNode(),"touched")&&this.doAction(a)},doAction:function(a){var b=this._actions,c;if(!!b)for(var d=0;d<b.length;d++)c=b[d],typeof c=="string"?this.getOwner()[c](this,a):c&&c(this,a)},addAction:function(a){this._actions=this._actions||[],this._actions.push(a)},setAction:function(a){this._actions=[a]}}}}),require.define({"mixins/animateable":function(a,b,c){__DEV__=0;var d=a("util");b.Animateable={animate:function(a,b,c,e){var f=[],g,h,i=this.getNode();d.forEach(a,function(a,b){b==="opacity"?g=a:f.push(b+"("+a+")")});if(typeof b=="function")var j=i.addEventListener("webkitTransitionEnd",function(){b(),i.removeEventListener("webkitTransitionEnd",arguments.callee)});this.setStyle({webkitTransition:"all "+(c!==undefined?c:.5)+"s "+(e||""),webkitTransform:f.join(" "),opacity:g})}}}}),require.define({"mixins/has_event_listeners":function(a,b,c){__DEV__=0;var d=a("util"),e=b.HasEventListeners={setEventListeners:function(a){this.clearEventListeners();var b=/^(\S+)\s+(.*)$/;for(var c in a){var d=c.match(b),e=d[1].split(",");for(var f=0;f<e.length;f++){var g=e[f],h=d[2],i=a[c];this.addListener(g,h,i)}}},clearEventListeners:function(){d.invoke(this._eventListeners||[],"remove")},addListener:function(a,b,c){var e=this.getNode(),f=d.bind(function(a){var d=e.querySelectorAll(b);for(var f=a.target;f&&f!==e;f=f.parentNode)for(var g=0;g<d.length;g++)d[g]===f&&this[c].call(this,a,f)},this);this._eventListeners=this._eventListeners||[];var g={e:a,selector:b,callback:f,remove:function(){e.removeEventListener(a,f)}};this._eventListeners.push(g),this.getNode().addEventListener(a,f);return g}}}}),require.define({"util/event_manager":function(a,b,c){__DEV__=0;var d=a("util"),e=a("mixins/events").Events;b.EventManager=d.extend({},e)}}),require.define({"util/image_queue":function(a,b,c){function m(a,b,c,d){e&&f?j.push({url:a,callback:b,scope:c,success:d}):b.call(c||window,a,d)}function l(){if(!e){var a=g.pop();if(!a)return;var b=document.createElement("img");b.onload=b.onerror=k,a.img=b,h.push(a),b.src=a.url}}function k(a){var b,c=a.type=="load";for(var d=0;d<h.length;d++){b=h[d];if(b.img===a.target){h.splice(d,1),i[b.url]=b.img,m(b.url,b.callback,b.scope,c);break}}e||l()}__DEV__=0;var d=2,e=!1,f=!1,g=[],h=[],i={},j=[],n=function(a,b,c,d){var e,f;for(e=0;e<a.length;e++)f=a[e],f.url==b&&f.callback===c&&(!d||d===f.scope)&&a.splice(e,1)};b.add=function(a,b,c){i[a]?m(a,b,c,!0):(g.push({url:a,callback:b,scope:c}),h.length<d&&l())},b.remove=function(a,b,c){n(g,a,b,c),n(h,a,b,c),n(j,a,b,c)},b.run=function(){e=!1;var a;for(var b=0;b<j.length;b++)a=j[b],m(a.url,a.callback,a.scope,a.success);j=[];while(g.length>0&&h.length<d)l()},b.pause=function(a){e=!0,f=a},b.clear=function(){g=[],h=[],j=[]}}}),require.define({iscroll:function(a,b,c){__DEV__=0,function(){function a(a,b){var h=this,i=document,j,k;h.wrapper=typeof a=="object"?a:i.getElementById(a),h.wrapper.style.overflow="hidden",h.scroller=h.wrapper.children[0],h.options={HWTransition:!0,HWCompositing:!0,hScroll:!0,vScroll:!0,hScrollbar:!0,vScrollbar:!0,fixedScrollbar:isAndroid,fadeScrollbar:g&&c||!d,hideScrollbar:g||!d,scrollbarClass:"",bounce:c,bounceLock:!1,momentum:c,lockDirection:!0,zoom:!1,zoomMin:1,zoomMax:4,snap:!1,pullToRefresh:!1,pullDownLabel:["Pull down to refresh...","Release to refresh...","Loading..."],pullUpLabel:["Pull up to refresh...","Release to refresh...","Loading..."],onPullDown:function(){},onPullUp:function(){},onScrollStart:null,onScrollChange:null,onScrollEnd:null,onZoomStart:null,onZoomEnd:null,checkDOMChange:!1};for(k in b)h.options[k]=b[k];h.options.HWCompositing=h.options.HWCompositing&&f,h.options.HWTransition=h.options.HWTransition&&f,h.options.HWCompositing?h.scroller.style.cssText+="-webkit-transition-property:-webkit-transform;-webkit-transform-origin:0 0;-webkit-transform:"+trnOpen+"0,0"+trnClose:h.scroller.style.cssText+="-webkit-transition-property:top,left;-webkit-transform-origin:0 0;top:0;left:0",h.options.HWTransition&&(h.scroller.style.cssText+="-webkit-transition-timing-function:cubic-bezier(0.33,0.66,0.66,1);-webkit-transition-duration:0;"),h.options.hScrollbar=h.options.hScroll&&h.options.hScrollbar,h.options.vScrollbar=h.options.vScroll&&h.options.vScrollbar,h.pullDownToRefresh=h.options.pullToRefresh=="down"||h.options.pullToRefresh=="both",h.pullUpToRefresh=h.options.pullToRefresh=="up"||h.options.pullToRefresh=="both",h.pullDownToRefresh&&(j=i.createElement("div"),j.className="iScrollPullDown",j.innerHTML='<span class="iScrollPullDownIcon"></span><span class="iScrollPullDownLabel">'+h.options.pullDownLabel[0]+"</span>\n",h.scroller.insertBefore(j,h.scroller.children[0]),h.options.bounce=!0,h.pullDownEl=j,h.pullDownLabel=j.getElementsByTagName("span")[1]),h.pullUpToRefresh&&(j=i.createElement("div"),j.className="iScrollPullUp",j.innerHTML='<span class="iScrollPullUpIcon"></span><span class="iScrollPullUpLabel">'+h.options.pullUpLabel[0]+"</span>\n",h.scroller.appendChild(j),h.options.bounce=!0,h.pullUpEl=j,h.pullUpLabel=j.getElementsByTagName("span")[1]),h.refresh(),h._bind(RESIZE_EV,window),h._bind(START_EV),e&&h.options.zoom&&(h._bind("gesturestart"),h.scroller.style.webkitTransform=h.scroller.style.webkitTransform+" scale(1)"),d||h._bind("mousewheel"),h.options.checkDOMChange&&(h.DOMChangeInterval=setInterval(function(){h._checkSize()},250))}a.prototype={x:0,y:0,currPageX:0,currPageY:0,pagesX:[],pagesY:[],offsetBottom:0,offsetTop:0,scale:1,lastScale:1,contentReady:!0,handleEvent:function(a){var b=this;switch(a.type){case START_EV:b._start(a);break;case MOVE_EV:b._move(a);break;case END_EV:case CANCEL_EV:b._end(a);break;case"webkitTransitionEnd":b._transitionEnd(a);break;case RESIZE_EV:b._resize();break;case"gesturestart":b._gestStart(a);break;case"gesturechange":b._gestChange(a);break;case"gestureend":case"gesturecancel":b._gestEnd(a);break;case"mousewheel":b._wheel(a);break;default:}},_scrollbar:function(a){var b=this,c=document,d;b[a+"Scrollbar"]?(b[a+"ScrollbarWrapper"]||(d=c.createElement("div"),b.options.scrollbarClass?d.className=b.options.scrollbarClass+a.toUpperCase():d.style.cssText="position:absolute;z-index:100;"+(a=="h"?"height:7px;bottom:1px;left:2px;right:7px":"width:7px;bottom:7px;top:2px;right:1px"),d.style.cssText+="pointer-events:none;-webkit-transition-property:opacity;-webkit-transition-duration:"+(b.options.fadeScrollbar?"350ms":"0")+";overflow:hidden;opacity:"+(b.options.hideScrollbar?"0":"1"),b.wrapper.appendChild(d),b[a+"ScrollbarWrapper"]=d,d=c.createElement("div"),b.options.scrollbarClass||(d.style.cssText="position:absolute;z-index:100;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);-webkit-background-clip:padding-box;-webkit-box-sizing:border-box;"+(a=="h"?"height:100%;-webkit-border-radius:4px 3px;":"width:100%;-webkit-border-radius:3px 4px;")),d.style.cssText+="pointer-events:none;-webkit-transition-property:-webkit-transform;-webkit-transition-timing-function:cubic-bezier(0.33,0.66,0.66,1);-webkit-transition-duration:0;-webkit-transform:"+trnOpen+"0,0"+trnClose,b[a+"ScrollbarWrapper"].appendChild(d),b[a+"ScrollbarIndicator"]=d),a=="h"?(b.hScrollbarSize=b.hScrollbarWrapper.clientWidth,b.hScrollbarIndicatorSize=m.max(m.round(b.hScrollbarSize*b.hScrollbarSize/b.scrollerW),8),b.hScrollbarIndicator.style.width=b.hScrollbarIndicatorSize+"px",b.hScrollbarMaxScroll=b.hScrollbarSize-b.hScrollbarIndicatorSize,b.hScrollbarProp=b.hScrollbarMaxScroll/b.maxScrollX):(b.vScrollbarSize=b.vScrollbarWrapper.clientHeight,b.vScrollbarIndicatorSize=m.max(m.round(b.vScrollbarSize*b.vScrollbarSize/b.scrollerH),8),b.vScrollbarIndicator.style.height=b.vScrollbarIndicatorSize+"px",b.vScrollbarMaxScroll=b.vScrollbarSize-b.vScrollbarIndicatorSize,b.vScrollbarProp=b.vScrollbarMaxScroll/b.maxScrollY),b._indicatorPos(a,!0)):b[a+"ScrollbarWrapper"]&&(b[a+"ScrollbarIndicator"].style.webkitTransform="",b[a+"ScrollbarWrapper"].parentNode.removeChild(b[a+"ScrollbarWrapper"]),b[a+"ScrollbarWrapper"]=null,b[a+"ScrollbarIndicator"]=null)},_resize:function(){var a=this;setTimeout(function(){a.refresh()},0)},_checkSize:function(){var a=this,b,c;if(!(a.moved||a.zoomed||!a.contentReady)){b=m.round(a.scroller.offsetWidth*a.scale),c=m.round((a.scroller.offsetHeight-a.offsetBottom-a.offsetTop)*a.scale);if(b==a.scrollerW&&c==a.scrollerH)return;a.refresh()}},_pos:function(a,b){var c=this;c.x=c.hScroll?a:0,c.y=c.vScroll?b:0,c.scroller.style.webkitTransform=trnOpen+c.x+"px,"+c.y+"px"+trnClose+" scale("+c.scale+")",c._indicatorPos("h"),c._indicatorPos("v")},_indicatorPos:function(a,b){var c=this,d=a=="h"?c.x:c.y;!c[a+"Scrollbar"]||(d=c[a+"ScrollbarProp"]*d,d<0?(d=c.options.fixedScrollbar?0:d+d*3,c[a+"ScrollbarIndicatorSize"]+d<9&&(d=-c[a+"ScrollbarIndicatorSize"]+8)):d>c[a+"ScrollbarMaxScroll"]&&(d=c.options.fixedScrollbar?c[a+"ScrollbarMaxScroll"]:d+(d-c[a+"ScrollbarMaxScroll"])*3,c[a+"ScrollbarIndicatorSize"]+c[a+"ScrollbarMaxScroll"]-d<9&&(d=c[a+"ScrollbarIndicatorSize"]+c[a+"ScrollbarMaxScroll"]-8)),c[a+"ScrollbarWrapper"].style.webkitTransitionDelay="0",c[a+"ScrollbarWrapper"].style.opacity=b&&c.options.hideScrollbar?"0":"1",c[a+"ScrollbarIndicator"].style.webkitTransform=trnOpen+(a=="h"?d+"px,0":"0,"+d+"px")+trnClose)},_transitionTime:function(a){var b=this;a+="ms",b.scroller.style.webkitTransitionDuration=a,b.hScrollbar&&(b.hScrollbarIndicator.style.webkitTransitionDuration=a),b.vScrollbar&&(b.vScrollbarIndicator.style.webkitTransitionDuration=a)},_start:function(a){var b=this,c=d?a.changedTouches[0]:a,f;b.moved=!1,a.preventDefault(),d&&a.touches.length==2&&b.options.zoom&&e&&!b.zoomed&&(b.originX=m.abs(a.touches[0].pageX+a.touches[1].pageX-b.wrapperOffsetLeft*2)/2-b.x,b.originY=m.abs(a.touches[0].pageY+a.touches[1].pageY-b.wrapperOffsetTop*2)/2-b.y),b.moved=!1,b.distX=0,b.distY=0,b.absDistX=0,b.absDistY=0,b.dirX=0,b.dirY=0,b.returnTime=0,b._transitionTime(0);if(b.options.momentum){b.scrollInterval&&(clearInterval(b.scrollInterval),b.scrollInterval=null);if(b.options.HWCompositing){f=new WebKitCSSMatrix(window.getComputedStyle(b.scroller,null).webkitTransform);if(f.m41!=b.x||f.m42!=b.y)b._unbind("webkitTransitionEnd"),b._pos(f.m41,f.m42)}else{f=window.getComputedStyle(b.scroller,null);if(b.x+"px"!=f.left||b.y+"px"!=f.top)b._unbind("webkitTransitionEnd"),b._pos(f.left.replace(/[^0-9]/g)*1,f.top.replace(/[^0-9]/g)*1)}}b.scroller.style.webkitTransitionTimingFunction="cubic-bezier(0.33,0.66,0.66,1)",b.hScrollbar&&(b.hScrollbarIndicator.style.webkitTransitionTimingFunction="cubic-bezier(0.33,0.66,0.66,1)"),b.vScrollbar&&(b.vScrollbarIndicator.style.webkitTransitionTimingFunction="cubic-bezier(0.33,0.66,0.66,1)"),b.startX=b.x,b.startY=b.y,b.pointX=c.pageX,b.pointY=c.pageY,b.startTime=a.timeStamp,b._bind(MOVE_EV),b._bind(END_EV),b._bind(CANCEL_EV)},_move:function(a){if(!(d&&a.touches.length>1)){var b=this,c=d?a.changedTouches[0]:a,e=c.pageX-b.pointX,f=c.pageY-b.pointY,g=b.x+e,h=b.y+f;a.preventDefault(),b.pointX=c.pageX,b.pointY=c.pageY;if(g>0||g<b.maxScrollX)g=b.options.bounce?b.x+e/2.4:g>=0||b.maxScrollX>=0?0:b.maxScrollX;if(h>0||h<b.maxScrollY)h=b.options.bounce?b.y+f/2.4:h>=0||b.maxScrollY>=0?0:b.maxScrollY,b.options.pullToRefresh&&b.contentReady&&(b.pullDownToRefresh&&h>b.offsetBottom?(b.pullDownEl.className="iScrollPullDown flip",b.pullDownLabel.innerText=b.options.pullDownLabel[1]):b.pullDownToRefresh&&b.pullDownEl.className.match("flip")&&(b.pullDownEl.className="iScrollPullDown",b.pullDownLabel.innerText=b.options.pullDownLabel[0]),b.pullUpToRefresh&&h<b.maxScrollY-b.offsetTop?(b.pullUpEl.className="iScrollPullUp flip",b.pullUpLabel.innerText=b.options.pullUpLabel[1]):b.pullUpToRefresh&&b.pullUpEl.className.match("flip")&&(b.pullUpEl.className="iScrollPullUp",b.pullUpLabel.innerText=b.options.pullUpLabel[0]));if(b.absDistX<4&&b.absDistY<4){b.distX+=e,b.distY+=f,b.absDistX=m.abs(b.distX),b.absDistY=m.abs(b.distY);return}b.options.lockDirection&&(b.absDistX>b.absDistY+3?(h=b.y,f=0):b.absDistY>b.absDistX+3&&(g=b.x,e=0)),!b.moved&&b.options.onScrollStart&&b.options.onScrollStart.call(b),b.moved=!0,b._pos(g,h),b.dirX=e>0?-1:e<0?1:0,b.dirY=f>0?-1:f<0?1:0,a.timeStamp-b.startTime>300&&(b.startTime=a.timeStamp,b.startX=b.x,b.startY=b.y)}},_end:function(a){if(!d||a.touches.length===0){var b=this,c=d?a.changedTouches[0]:a,e,f,g={dist:0,time:0},h={dist:0,time:0},i=a.timeStamp-b.startTime,j=b.x,k=b.y,l,n;b._unbind(MOVE_EV),b._unbind(END_EV),b._unbind(CANCEL_EV);if(b.zoomed)return;if(!b.moved){d&&b.options.zoom&&(b.doubleTapTimer?(clearTimeout(b.doubleTapTimer),b.doubleTapTimer=null,b.zoom(b.pointX,b.pointY,b.scale==1?2:1)):b.doubleTapTimer=setTimeout(function(){b.doubleTapTimer=null,e=c.target;while(e.nodeType!=1)e=e.parentNode;f=document.createEvent("MouseEvents"),f.initMouseEvent("click",!0,!0,a.view,1,c.screenX,c.screenY,c.clientX,c.clientY,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,0,null),f._fake=!0,e.dispatchEvent(f)},b.options.zoom?250:0)),b._resetPos();return}b.pullDownToRefresh&&b.contentReady&&b.pullDownEl.className.match("flip")&&(b.pullDownEl.className="iScrollPullDown loading",b.pullDownLabel.innerText=b.options.pullDownLabel[2],b.scroller.style.marginTop="0",b.offsetBottom=0,b.refresh(),b.contentReady=!1,b.options.onPullDown()),b.pullUpToRefresh&&b.contentReady&&b.pullUpEl.className.match("flip")&&(b.pullUpEl.className="iScrollPullUp loading",b.pullUpLabel.innerText=b.options.pullUpLabel[2],b.scroller.style.marginBottom="0",b.offsetTop=0,b.refresh(),b.contentReady=!1,b.options.onPullUp());if(i<300&&b.options.momentum){g=j?b._momentum(j-b.startX,i,-b.x,b.scrollerW-b.wrapperW+b.x,b.options.bounce?b.wrapperW:0):g,h=k?b._momentum(k-b.startY,i,-b.y,b.maxScrollY<0?b.scrollerH-b.wrapperH+b.y:0,b.options.bounce?b.wrapperH:0):h,j=b.x+g.dist,k=b.y+h.dist;if(b.x>0&&j>0||b.x<b.maxScrollX&&j<b.maxScrollX)g={dist:0,time:0};if(b.y>0&&k>0||b.y<b.maxScrollY&&k<b.maxScrollY)h={dist:0,time:0}}if(g.dist||h.dist){l=m.max(m.max(g.time,h.time),10),b.options.snap&&(n=b._snap(j,k),j=n.x,k=n.y,l=m.max(n.time,l)),b.options.onScrollChange&&b.options.onScrollChange.call(b,j,k),b.scrollTo(j,k,l);return}if(b.options.snap){n=b._snap(b.x,b.y);if(n.x!=b.x||n.y!=b.y)b.options.onScrollChange&&b.options.onScrollChange.call(b,j,k),b.scrollTo(n.x,n.y,n.time);return}b._resetPos()}},_resetPos:function(a){var b=this,c=b.x,d=b.y;b.x>=0?c=0:b.x<b.maxScrollX&&(c=b.maxScrollX),b.y>=0||b.maxScrollY>0?d=0:b.y<b.maxScrollY&&(d=b.maxScrollY);c==b.x&&d==b.y?(b.moved&&(b.options.onScrollEnd&&b.options.onScrollEnd.call(b),b.moved=!1),b.zoomed&&(b.options.onZoomEnd&&b.options.onZoomEnd.call(b),b.zoomed=!1),b.hScrollbar&&b.options.hideScrollbar&&(b.hScrollbarWrapper.style.webkitTransitionDelay="300ms",b.hScrollbarWrapper.style.opacity="0"),b.vScrollbar&&b.options.hideScrollbar&&(b.vScrollbarWrapper.style.webkitTransitionDelay="300ms",b.vScrollbarWrapper.style.opacity="0")):(a===undefined&&(a=200),a&&(b.scroller.style.webkitTransitionTimingFunction="cubic-bezier(0.33,0.0,0.33,1)",b.hScrollbar&&(b.hScrollbarIndicator.style.webkitTransitionTimingFunction="cubic-bezier(0.33,0.0,0.33,1)"),b.vScrollbar&&(b.vScrollbarIndicator.style.webkitTransitionTimingFunction="cubic-bezier(0.33,0.0,0.33,1)")),b.scrollTo(c,d,a))},_timedScroll:function(a,b,c){var d=this,e=d.x,f=d.y,g=(new Date).getTime(),h;d._transitionTime(0),d.scrollInterval&&(clearInterval(d.scrollInterval),d.scrollInterval=null),d.scrollInterval=setInterval(function(){var i=(new Date).getTime(),j,k;i>=g+c?(clearInterval(d.scrollInterval),d.scrollInterval=null,d._pos(a,b),d._transitionEnd()):(i=(i-g)/c-1,h=m.sqrt(1-i*i),j=(a-e)*h+e,k=(b-f)*h+f,d._pos(j,k))},20)},_transitionEnd:function(a){var b=this;a&&a.stopPropagation(),b._unbind("webkitTransitionEnd"),b._resetPos(b.returnTime),b.returnTime=0},_gestStart:function(a){var b=this;b._transitionTime(0),b.lastScale=1,b.options.onZoomStart&&b.options.onZoomStart.call(b),b._unbind("gesturestart"),b._bind("gesturechange"),b._bind("gestureend"),b._bind("gesturecancel")},_gestChange:function(a){var b=this,c=b.scale*a.scale,d,e,f;b.zoomed=!0,c<b.options.zoomMin?c=b.options.zoomMin:c>b.options.zoomMax&&(c=b.options.zoomMax),f=c/b.scale,d=b.originX-b.originX*f+b.x,e=b.originY-b.originY*f+b.y,b.scroller.style.webkitTransform=trnOpen+d+"px,"+e+"px"+trnClose+" scale("+c+")",b.lastScale=f},_gestEnd:function(a){var b=this,c=b.scale,d=b.lastScale;b.scale=c*d,b.scale<b.options.zoomMin+.05?b.scale=b.options.zoomMin:b.scale>b.options.zoomMax-.05&&(b.scale=b.options.zoomMax),d=b.scale/c,b.x=b.originX-b.originX*d+b.x,b.y=b.originY-b.originY*d+b.y,b.scroller.style.webkitTransform=trnOpen+b.x+"px,"+b.y+"px"+trnClose+" scale("+b.scale+")",setTimeout(function(){b.refresh()},0),b._bind("gesturestart"),b._unbind("gesturechange"),b._unbind("gestureend"),b._unbind("gesturecancel")},_wheel:function(a){var b=this,c=b.x+a.wheelDeltaX/12,d=b.y+a.wheelDeltaY/12;c>0?c=0:c<b.maxScrollX&&(c=b.maxScrollX),d>0?d=0:d<b.maxScrollY&&(d=b.maxScrollY),b.scrollTo(c,d,0)},_momentum:function(a,b,c,d,e){var f=this,g=6e-4,h=m.abs(a)/b,i=h*h/(2*g),j=0,k=0;a>0&&i>c?(k=e/(6/(i/h*g)),c=c+k,f.returnTime=800/e*k+100,h=h*c/i,i=c):a<0&&i>d&&(k=e/(6/(i/h*g)),d=d+k,f.returnTime=800/e*k+100,h=h*d/i,i=d),i=i*(a<0?-1:1),j=h/g;return{dist:i,time:m.round(j)}},_offset:function(a,b){var c=-a.offsetLeft,d=-a.offsetTop;if(!b)return{x:c,y:d};while(a=a.offsetParent)c-=a.offsetLeft,d-=a.offsetTop;return{x:c,y:d}},_snap:function(a,b){var c=this,d,e,f,g,h,i;f=c.pagesX.length-1;for(d=0,e=c.pagesX.length;d<e;d++)if(a>=c.pagesX[d]){f=d;break}f==c.currPageX&&f>0&&c.dirX<0&&f--,a=c.pagesX[f],h=m.abs(a-c.pagesX[c.currPageX]),h=h?m.abs(c.x-a)/h*500:0,c.currPageX=f,f=c.pagesY.length-1;for(d=0;d<f;d++)if(b>=c.pagesY[d]){f=d;break}f==c.currPageY&&f>0&&c.dirY<0&&f--,b=c.pagesY[f],i=m.abs(b-c.pagesY[c.currPageY]),i=i?m.abs(c.y-b)/i*500:0,c.currPageY=f,g=m.round(m.max(h,i))||200;return{x:a,y:b,time:g}},_bind:function(a,b){(b||this.scroller).addEventListener(a,this,!1)},_unbind:function(a,b){(b||this.scroller).removeEventListener(a,this,!1)},destroy:function(){var a=this;a.options.checkDOMChange&&clearTimeout(a.DOMChangeInterval),a.pullDownToRefresh&&a.pullDownEl.parentNode.removeChild(a.pullDownEl),a.pullUpToRefresh&&a.pullUpEl.parentNode.removeChild(a.pullUpEl),a.hScrollbar=!1,a.vScrollbar=!1,a._scrollbar("h"),a._scrollbar("v"),a.scroller.style.webkitTransform="",a._unbind("webkitTransitionEnd"),a._unbind(RESIZE_EV),a._unbind(START_EV),a._unbind(MOVE_EV),a._unbind(END_EV),a._unbind(CANCEL_EV),a.options.zoom&&(a._unbind("gesturestart"),a._unbind("gesturechange"),a._unbind("gestureend"),a._unbind("gesturecancel"))},refresh:function(){var a=this,b=0,c=0,d,e,f,g,h,i;a.pullDownToRefresh&&(i=a.pullDownEl.className.match("loading"),i&&!a.contentReady?(g=a.scrollerH,a.contentReady=!0,a.pullDownEl.className="iScrollPullDown",a.pullDownLabel.innerText=a.options.pullDownLabel[0],a.offsetBottom=a.pullDownEl.offsetHeight,a.scroller.style.marginTop=-a.offsetBottom+"px"):i||(a.offsetBottom=a.pullDownEl.offsetHeight,a.scroller.style.marginTop=-a.offsetBottom+"px")),a.pullUpToRefresh&&(i=a.pullUpEl.className.match("loading"),i&&!a.contentReady?(g=a.scrollerH,a.contentReady=!0,a.pullUpEl.className="iScrollPullUp",a.pullUpLabel.innerText=a.options.pullUpLabel[0],a.offsetTop=a.pullUpEl.offsetHeight,a.scroller.style.marginBottom=-a.offsetTop+"px"):i||(a.offsetTop=a.pullUpEl.offsetHeight,a.scroller.style.marginBottom=-a.offsetTop+"px")),a.wrapperW=a.wrapper.clientWidth,a.wrapperH=a.wrapper.clientHeight,a.scrollerW=m.round(a.scroller.offsetWidth*a.scale),a.scrollerH=m.round((a.scroller.offsetHeight-a.offsetBottom-a.offsetTop)*a.scale),a.maxScrollX=a.wrapperW-a.scrollerW,a.maxScrollY=a.wrapperH-a.scrollerH,a.dirX=0,a.dirY=0,a._transitionTime(0),a.hScroll=a.options.hScroll&&a.maxScrollX<0,a.vScroll=a.options.vScroll&&(!a.options.bounceLock&&!a.hScroll||a.scrollerH>a.wrapperH),a.hScrollbar=a.hScroll&&a.options.hScrollbar,a.vScrollbar=a.vScroll&&a.options.vScrollbar&&a.scrollerH>a.wrapperH,a._scrollbar("h"),a._scrollbar("v");if(typeof a.options.snap=="string"){a.pagesX=[],a.pagesY=[],f=a.scroller.querySelectorAll(a.options.snap);for(d=0,e=f.length;d<e;d++)b=a._offset(f[d]),a.pagesX[d]=b.x<a.maxScrollX?a.maxScrollX:b.x*a.scale,a.pagesY[d]=b.y<a.maxScrollY?a.maxScrollY:b.y*a.scale}else if(a.options.snap){a.pagesX=[];while(b>=a.maxScrollX&&a.wrapperW>0)a.pagesX[c]=b,b=b-a.wrapperW,c++;a.maxScrollX%a.wrapperW&&(a.pagesX[a.pagesX.length]=a.maxScrollX-a.pagesX[a.pagesX.length-1]+a.pagesX[a.pagesX.length-1]),b=0,c=0,a.pagesY=[];while(b>=a.maxScrollY&&a.wrapperH>0)a.pagesY[c]=b,b=b-a.wrapperH,c++;a.maxScrollY%a.wrapperH&&(a.pagesY[a.pagesY.length]=a.maxScrollY-a.pagesY[a.pagesY.length-1]+a.pagesY[a.pagesY.length-1])}a.options.zoom&&(h=a._offset(a.wrapper,!0),a.wrapperOffsetLeft=-h.x,a.wrapperOffsetTop=-h.y),g&&a.y==0&&(g=g-a.scrollerH+a.y,a.scrollTo(0,g,0)),a._resetPos()},scrollTo:function(a,b,c,d){var e=this;d&&(a=e.x-a,b=e.y-b),c=!c||m.round(e.x)==m.round(a)&&m.round(e.y)==m.round(b)?0:c,e.moved=!0;e.options.HWTransition?(c&&e._bind("webkitTransitionEnd"),e._transitionTime(c),e._pos(a,b),c||setTimeout(function(){e._transitionEnd()},0)):e._timedScroll(a,b,c)},scrollToElement:function(a,b){var c=this,d;a=a.nodeType?a:c.scroller.querySelector(a);!a||(d=c._offset(a),d.x=d.x>0?0:d.x<c.maxScrollX?c.maxScrollX:d.x,d.y=d.y>0?0:d.y<c.maxScrollY?c.maxScrollY:d.y,b=b===undefined?m.max(m.abs(d.x)*2,m.abs(d.y)*2):b,c.scrollTo(d.x,d.y,b))},scrollToPage:function(a,b,c){var d=this,e,f;d.options.snap?(a=a=="next"?d.currPageX+1:a=="prev"?d.currPageX-1:a,b=b=="next"?d.currPageY+1:b=="prev"?d.currPageY-1:b,a=a<0?0:a>d.pagesX.length-1?d.pagesX.length-1:a,b=b<0?0:b>d.pagesY.length-1?d.pagesY.length-1:b,d.currPageX=a,d.currPageY=b,e=d.pagesX[a],f=d.pagesY[b]):(e=-d.wrapperW*a,f=-d.wrapperH*b,e<d.maxScrollX&&(e=d.maxScrollX),f<d.maxScrollY&&(f=d.maxScrollY)),d.scrollTo(e,f,c||400)},zoom:function(a,b,c){var d=this,e=c/d.scale;a=a-d.wrapperOffsetLeft-d.x,b=b-d.wrapperOffsetTop-d.y,d.x=a-a*e+d.x,d.y=b-b*e+d.y,d.scale=c,d.options.onZoomStart&&d.options.onZoomStart.call(d),d.refresh(),d._bind("webkitTransitionEnd"),d._transitionTime(200),setTimeout(function(){d.zoomed=!0,d.scroller.style.webkitTransform=trnOpen+d.x+"px,"+d.y+"px"+trnClose+" scale("+c+")"},0)}};var c="WebKitCSSMatrix"in window&&"m11"in new WebKitCSSMatrix,d="ontouchstart"in window,e="ongesturestart"in window,f="WebKitTransitionEvent"in window,g=!0;isAndroid=!1,RESIZE_EV="onorientationchange"in window?"orientationchange":"resize",START_EV=d?"touchstart":"mousedown",MOVE_EV=d?"touchmove":"mousemove",END_EV=d?"touchend":"mouseup",CANCEL_EV=d?"touchcancel":"mouseup",trnOpen="translate"+(c?"3d(":"("),trnClose=c?",0)":")",m=Math,typeof b!="undefined"?b.iScroll=a:window.iScroll=a}()}}),require.define({tokenizer:function(a,b,c){__DEV__=0,JX.install("Tokenizer",{construct:function(a){this._containerNode=a},properties:{limit:null,nextInput:null},members:{_containerNode:null,_root:null,_focus:null,_orig:null,_typeahead:null,_tokenid:0,_tokens:null,_tokenMap:null,_initialValue:null,_seq:0,_lastvalue:null,start:function(){if(__DEV__&&!this._typeahead)throw new Error("JX.Tokenizer.start(): No typeahead configured! Use setTypeahead() to provide a typeahead.");this._orig=JX.DOM.find(this._containerNode,"input","tokenizer"),this._tokens=[],this._tokenMap={};var a=this.buildInput(this._orig.value);this._focus=a,JX.DOM.listen(a,["click","focus","blur","keydown"],null,JX.bind(this,this.handleEvent)),JX.DOM.listen(this._containerNode,"click",null,JX.bind(this,function(a){a.getNode("remove")?this._remove(a.getNodeData("token").key):a.getTarget()==this._root&&this.focus()}));var b=JX.$N("div");b.id=this._orig.id,JX.DOM.alterClass(b,"jx-tokenizer",!0),b.style.cursor="text",this._root=b,b.appendChild(a);var c=this._typeahead;c.setInputNode(this._focus),c.start(),JX.defer(JX.bind(this,function(){var a=this._orig.parentNode;JX.DOM.setContent(a,b);var c=this._initialValue||{};for(var d in c)this.addToken(d,c[d]);JX.DOM.appendContent(b,JX.$N("div",{style:{clear:"both"}})),this._redraw()}))},setInitialValue:function(a){this._initialValue=a;return this},setTypeahead:function(a){a.setAllowNullSelection(!1),a.listen("choose",JX.bind(this,function(a){JX.Stratcom.context().prevent(),this.addToken(a.rel,a.name)&&(this._typeahead.hide(),this._focus.value="",this._redraw(),this.focus())})),a.listen("query",JX.bind(this,function(a){a.length&&JX.Stratcom.context().prevent()})),this._typeahead=a;return this},handleEvent:function(a){this._typeahead.handleEvent(a);if(!a.getPrevented())if(a.getType()=="click"){if(a.getTarget()==this._root){this.focus(),a.prevent();return}}else a.getType()=="keydown"?this._onkeydown(a):a.getType()=="blur"&&this._redraw()},refresh:function(){this._redraw(!0);return this},_redraw:function(a){var b=this._focus;if(b.value!==this._lastvalue||!!a){this._lastvalue=b.value;var c=this._root,d=JX.DOM.textMetrics(this._focus,"jx-tokenizer-metrics");d.y=null,d.x+=24,d.setDim(b),b.value=b.value}},addToken:function(a,b){if(a in this._tokenMap)return!1;var c=this._focus,d=this._root,e=this.buildToken(a,b);this._tokenMap[a]={value:b,key:a,node:e},this._tokens.push(a),d.insertBefore(e,c);return!0},buildInput:function(a){return JX.$N("input",{className:"jx-tokenizer-input",type:"text",value:a})},buildToken:function(a,b){var c=JX.$N("input",{type:"hidden",value:a,name:this._orig.name+"["+this._seq++ +"]"}),d=JX.$N("a",{className:"jx-tokenizer-x",sigil:"remove"},JX.$H("&times;"));return JX.$N("a",{className:"jx-tokenizer-token",sigil:"token",meta:{key:a}},[b,c,d])},getTokens:function(){var a={};for(var b in this._tokenMap)a[b]=this._tokenMap[b].value;return a},_onkeydown:function(a){var b=this._focus,c=this._root;switch(a.getSpecialKey()){case"tab":var d=this._typeahead.submit();this.getNextInput()&&(d||(this._focus.value=""),JX.defer(JX.bind(this,function(){this.getNextInput().focus()})));break;case"delete":if(!this._focus.value.length){var e;while(e=this._tokens.pop())if(this._remove(e))break}break;case"return":break;default:this.getLimit()&&JX.keys(this._tokenMap).length==this.getLimit()&&a.prevent(),JX.defer(JX.bind(this,this._redraw))}},_remove:function(a){if(!this._tokenMap[a])return!1;JX.DOM.remove(this._tokenMap[a].node),delete this._tokenMap[a],this._redraw(!0),this.focus();return!0},focus:function(){var a=this._focus;JX.DOM.show(a),JX.defer(function(){JX.DOM.focus(a)})}}})}}),require.define({"typeahead/Typeahead":function(a,b,c){__DEV__=0,a("javelin/core"),JX.install("Typeahead",{construct:function(a,b){this._hardpoint=a,this._control=b||JX.DOM.find(a,"input"),this._root=JX.$N("div",{className:"jx-typeahead-results"}),this._display=[],this._listener=JX.DOM.listen(this._control,["focus","blur","keypress","keydown"],null,JX.bind(this,this.handleEvent)),JX.DOM.listen(this._root,["mouseover","mouseout"],null,JX.bind(this,this._onmouse)),JX.DOM.listen(this._root,"mousedown","tag:a",JX.bind(this,function(a){this._choose(a.getNode("tag:a")),a.prevent()}))},events:["choose","query","start","change","show"],properties:{allowNullSelection:!0,normalizer:null,blurDefer:0},members:{_root:null,_control:null,_hardpoint:null,_listener:null,_value:null,_stop:!1,_focus:-1,_display:null,_hasFocus:!1,start:function(){this.invoke("start")},setDatasource:function(a){a.bindToTypeahead(this)},setInputNode:function(a){this._control=a;return this},hide:function(){this._changeFocus(Number.NEGATIVE_INFINITY),this._display=[],this._moused=!1,JX.DOM.setContent(this._root,""),JX.DOM.remove(this._root)},showResults:function(a){var b={show:a},c=this.invoke("show",b);this._display=b.show;if(this._display.length&&!c.getPrevented()){JX.DOM.setContent(this._root,this._display),this._changeFocus(Number.NEGATIVE_INFINITY);var d=JX.Vector.getDim(this._hardpoint);d.x=0,d.setPos(this._root),this._hardpoint.appendChild(this._root)}else this.hide()},refresh:function(){if(!this._stop){this._value=this._control.value;if(!this.invoke("change",this._value).getPrevented()&&__DEV__)throw new Error("JX.Typeahead._update(): No listener responded to Typeahead 'change' event. Create a datasource and call setDatasource().")}},waitForResults:function(){this.hide()},_onmouse:function(a){this._moused=a.getType()=="mouseover",this._drawFocus()},_changeFocus:function(a){var b=Math.min(Math.max(-1,this._focus+a),this._display.length-1);this.getAllowNullSelection()||(b=Math.max(0,b)),this._focus>=0&&this._focus<this._display.length&&JX.DOM.alterClass(this._display[this._focus],"focused",0),this._focus=b,this._drawFocus();return!0},_drawFocus:function(){var a=this._display[this._focus];a&&JX.DOM.alterClass(a,"focused",!this._moused)},_choose:function(a){var b=this.invoke("choose",a);b.getPrevented()||(this._control.value=a.name,this.hide())},clear:function(){this._control.value="",this.hide()},disable:function(){this._control.blur(),this._control.disabled=!0,this._stop=!0},submit:function(){if(this._focus>=0&&this._display[this._focus]){this._choose(this._display[this._focus]);return!0}result=this.invoke("query",this._control.value);if(result.getPrevented())return!0;return!1},setValue:function(a){this._control.value=a},getValue:function(){return this._control.value},_update:function(a){var b=a&&a.getSpecialKey();if(b&&a.getType()=="keydown")switch(b){case"up":this._display.length&&this._changeFocus(-1)&&a.prevent();break;case"down":this._display.length&&this._changeFocus(1)&&a.prevent();break;case"return":if(this.submit()){a.prevent();return}break;case"esc":this._display.length&&this.getAllowNullSelection()&&(this.hide(),a.prevent());break;case"tab":return}JX.defer(JX.bind(this,function(){this._value!=this._control.value&&this.refresh()}))},handleEvent:function(a){if(!this._stop&&!a.getPrevented()){var b=a.getType();b=="blur"?(this._hasFocus=!1,JX.defer(JX.bind(this,function(){this._hasFocus||this.hide()}),this.getBlurDefer())):b=="focus"?this._hasFocus=!0:this._update(a)}},removeListener:function(){this._listener&&this._listener.remove()}}})}}),require.define({"typeahead/normalizer/TypeaheadInternationalNormalizer":function(a,b,c){__DEV__=0,a("javelin/core"),a("typeahead/normalizer/TypeaheadNormalizer"),JX.install("TypeaheadInternationalNormalizer",{statics:{normalize:function(a){var b=JX.TypeaheadInternationalNormalizer._charmap;return JX.TypeaheadNormalizer.normalize(a).replace(/[\u00e0-\u0450]/g,function(a){return a in b?b[a]:a})},_charmap:{"à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","æ":"ae","ç":"c","è":"e","é":"e","ê":"e","ë":"e","ì":"i","í":"i","î":"i","ï":"i","ð":"d","ñ":"n","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","ù":"u","ú":"u","û":"u","ü":"u","ý":"y","ÿ":"y","œ":"oe","а":"a","б":"b","в":"v","г":"g","д":"d","е":"e","з":"z","и":"i","й":"j","к":"k","л":"l","м":"m","н":"n","о":"o","п":"p","р":"r","с":"s","т":"t","у":"u","ф":"f","х":"h","ц":"c","ч":"ch","ш":"sh","ы":"y","э":"e","ю":"u","я":"ya"}}})}}),require.define({"typeahead/normalizer/TypeaheadNormalizer":function(a,b,c){__DEV__=0,a("javelin/core"),JX.install("TypeaheadNormalizer",{statics:{normalize:function(a){return(""+a).toLowerCase().replace(/[^a-z0-9 ]/g,"").replace(/ +/g," ").replace(/^\s*|\s*$/g,"")}}})}}),require.define({"typeahead/source/TypeaheadOnDemandSource":function(a,b,c){__DEV__=0,a("javelin/core"),a("typeahead/source/TypeaheadSource"),JX.install("TypeaheadOnDemandSource",{extend:"TypeaheadSource",construct:function(a){JX.TypeaheadSource.call(this),this.uri=a,this.haveData={"":!0}},properties:{queryDelay:125,auxiliaryData:{}},members:{uri:null,lastChange:null,haveData:null,didChange:function(a){JX.Stratcom.pass()||(this.lastChange=(new Date).getTime(),a=this.normalize(a),this.haveData[a]?this.matchResults(a):(this.waitForResults(),JX.defer(JX.bind(this,this.sendRequest,this.lastChange,a),this.getQueryDelay())),JX.Stratcom.context().kill())},sendRequest:function(a,b){if(a==this.lastChange){var c=new JX.Request(this.uri,JX.bind(this,this.ondata,this.lastChange,b));c.setMethod("GET"),c.setData(JX.copy(this.getAuxiliaryData(),{q:b})),c.send()}},ondata:function(a,b,c){if(c)for(var d=0;d<c.length;d++)this.addResult(c[d]);this.haveData[b]=!0;a==this.lastChange&&this.matchResults(b)}}})}}),require.define({"typeahead/source/TypeaheadPreloadedSource":function(a,b,c){__DEV__=0,a("javelin/core"),a("typeahead/source/TypeaheadSource"),JX.install("TypeaheadPreloadedSource",{extend:"TypeaheadSource",construct:function(a){JX.TypeaheadSource.call(this),this.uri=a},members:{ready:!1,uri:null,lastValue:null,didChange:function(a){this.ready?this.matchResults(a):(this.lastValue=a,this.waitForResults()),JX.Stratcom.context().kill()},didStart:function(){var a=new JX.Request(this.uri,JX.bind(this,this.ondata));a.setMethod("GET"),a.send()},ondata:function(a){for(var b=0;b<a.length;++b)this.addResult(a[b]);this.lastValue!==null&&this.matchResults(this.lastValue),this.ready=!0}}})}}),require.define({"typeahead/source/TypeaheadSource":function(a,b,c){__DEV__=0,a("javelin/core"),a("typeahead/normalizer/TypeaheadNormalizer"),JX.install("TypeaheadSource",{construct:function(){this._raw={},this._lookup={},this.setNormalizer(JX.TypeaheadNormalizer.normalize)},properties:{normalizer:null,transformer:null,maximumResultCount:5},members:{_raw:null,_lookup:null,_typeahead:null,_normalizer:null,bindToTypeahead:function(a){this._typeahead=a,a.listen("change",JX.bind(this,this.didChange)),a.listen("start",JX.bind(this,this.didStart))},didChange:function(a){return},didStart:function(){return},clearCache:function(){this._raw={},this._lookup={}},addResult:function(a){a=(this.getTransformer()||this._defaultTransformer)(a);if(!(a.id in this._raw)){if(__DEV__)for(var b in{name:1,id:1,display:1,uri:1})if(!(b in a))throw new Error("JX.TypeaheadSource.addResult(): result must have properties 'name', 'id', 'uri' and 'display'.");this._raw[a.id]=a;var c=this.tokenize(a.name);for(var d=0;d<c.length;++d)this._lookup[c[d]]=this._lookup[c[d]]||[],this._lookup[c[d]].push(a.id)}},waitForResults:function(){this._typeahead.waitForResults();return this},matchResults:function(a){var b={},c={},d={},e={},f=this.tokenize(a);f.sort(function(a,b){return b.length-a.length});for(var g=0;g<f.length;++g){if(f[g]in e){f.splice(g--,1);continue}e[f[g]]=!0;var h=f[g];for(var i in this._lookup)if(i.substr(0,h.length)===h){if(i in d)continue;d[i]=!0;var j=this._lookup[i];for(var k=0;k<j.length;++k){var l=j[k];c[l]||(c[l]={}),h in c[l]||(c[l][h]=!0,b[l]=(b[l]||0)+1)}}}var m=[];for(var n in b)b[n]==f.length&&m.push(n);this._typeahead.showResults(this.renderNodes(a,m))},renderNodes:function(a,b){var c=Math.min(this.getMaximumResultCount(),b.length),d=[];for(var e=0;e<c;e++)d.push(this.createNode(this._raw[b[e]]));return d},createNode:function(a){return JX.$N("a",{href:a.uri,name:a.name,rel:a.id,className:"jx-result"},a.display)},normalize:function(a){return(this.getNormalizer()||JX.bag())(a)},tokenize:function(a){a=this.normalize(a);if(!a.length)return[];return a.split(/ /g)},_defaultTransformer:function(a){return{name:a[0],display:a[0],uri:a[1],id:a[2]}}}})}}),require.define({"views/action_scroller":function(a,b,c){__DEV__=0,a("views/scroll_view"),a("views/button"),a("views/layout/vbox");var d=a("view").View,e=a("views/action_sheet").ActionSheet,f=a("util");b.ActionScroller=a("javelin/core").createClass({name:"ActionScroller",extend:e,construct:function(a){this.buttons=[],this.scrollToElement=f.bind(this.scrollToElement,this),e.call(this,a)},members:{didScrollTo:function(a,b,c){var d=this.getNode().offsetHeight/2,e=-b+d,f=c.getMetadata().column,g,h=this.getNode().offsetHeight,i,j,k=this.buttons.length;for(var l=0;l<k;l++){if(this.buttons[l].getMetadata().column!=f)continue;i=this.buttons[l].getNode(),g=Math.floor(e-(i.offsetTop+i.offsetHeight/2)),Math.abs(g)<Math.abs(h)&&(h=g,j=this.buttons[l])}j&&!j.getMetadata().actioned&&j.doAction(null)},scrollToElement:function(a,b){var c=a.getNode(),d=a.getMetadata().column,e=this.getColumn(d),f=e.coords()[1],g=Math.floor(-(c.offsetTop+c.offsetHeight/2)-(f-this.getDesiredHeight()/2));f+g>0&&(g=-f),g!==0&&setTimeout(function(){e.scrollTo(0,-g,b?0:200,!0)},1)},setSelectedAction:function(a){a=f.$AX(a);var b=(this.getSelectedAction()||[]).concat(a);this.setProperty("selectedAction",b),this._visible&&this.chooseSelectedAction(!1)},updateHeight:function(a){var b=this.findRef("actionContainer").getChildViews();setTimeout(f.bind(function(){f.invoke(b,"refresh"),this.chooseSelectedAction(!0)},this),0)},chooseSelectedAction:function(a){var b=this.getSelectedAction()||[];this.setProperty("selectedAction",[]);var c={},d;for(var e=0;e<b.length;e++){d=b[e];for(var f=0;f<this.buttons.length;f++)metadata=this.buttons[f].getMetadata(),metadata.actionId==d&&!c[metadata.column]&&(c[metadata.column]=1,this.scrollToElement(this.buttons[f],a),this.markActioned(this.buttons[f]))}},getDesiredHeight:function(){return 216},appendButton:function(a,b){this.buttons.push(a),a.addAction(this.handleAction),this.getColumn(b),this.findRef("container"+b).append(this.build({className:"bolt-button-wrapper",childViews:[a]}))},createColumn:function(a){var b="bolt-action-scroller-col";return{view:"ScrollView",ref:"col"+a,flex:1,useScrollbar:!1,additionalClasses:b+" "+b+"-"+a,metadata:{column:a},style:{height:this.getDesiredHeight()+"px"},childViews:[{ref:"container"+a,view:"VBox",additionalClasses:"bolt-action-scroll-container"}]}},markActioned:function(a){var b=a.getMetadata().column,c;for(var d=0;d<this.buttons.length;d++)c=this.buttons[d].getMetadata,c.column==b&&(c.actioned=!1);c=a.getMetadata(),c.actioned=!0,a.setMetadata(c)},handleAction:function(a){this.markActioned(a),this.scrollToElement(a)}}})}}),require.define({"views/action_sheet":function(a,b,c){__DEV__=0,a("views/button");var d=a("util"),e=a("view");a("views/layout/vbox"),a("views/layout/hbox");var f=e.View,g=0,h=a("javelin/core").createClass({name:"ActionSheet",extend:f,properties:{destroyOnHide:!1,actions:null,selectedAction:null},construct:function(a){this.handleAction=d.bind(this.handleAction,this),f.call(this,a)},members:{_title:null,_text:null,_visible:!1,render:function(){this.setLayout({ref:"actionContainer",view:"HBox"}),this.setMode("sync_hidden","state")},addAction:function(a){var b=a.col||0,c=a.actionId||this.generateId(),e=a.selected,f=a.metadata||{};delete a.col,delete a.actionId,delete a.selected,delete a.metadata;var g=this.build(d.extend({view:"Button",metadata:d.extend(f,{column:b,actionId:c})},a),this.getOwner()||this);this.appendButton(g,b);var h=this.getDesiredHeight();this.updateHeight&&this.updateHeight(h),this.setStyle({height:h,bottom:"-"+h+"px"}),e&&this.setSelectedAction(c)},appendButton:function(a,b){a.addAction(this.handleAction),this.getColumn(b).append(a)},generateId:function(){return"actionId_"+ ++g},getColumn:function(a){var b=this.findRef("col"+a);if(!b){var c=this.findRef("actionContainer"),d=c.getChildViews(),e=d.length,f;for(var g=0;g<d.length;g++){f=d[g].getMetadata();if(!f)continue;if(f.column>a){e=g;break}}b=this.build(this.createColumn(a)),c.insertChild(b,e)}return b},createColumn:function(a){return{view:"VBox",ref:"col"+a,flex:1,metadata:{column:a}}},hide:function(){this._visible=!1,this.setMode("hidden","state");var a=this.getNode().style,b=this;setTimeout(function(){a.display="none",b.getDestroyOnHide()&&b.destroy()},300)},setActions:function(a){a&&d.forEach(a,function(a){this.addAction(a)},this)},_setContent:function(a,b,c){b?this[a]?this[a].setContent(b):c():(this.removeChild(this[a]),this[a]=null)},setText:function(a){var b=this;this._setContent("_text",a,function(){b._text=b.build({tagName:"h3",content:a}),b.insertChild(b._text,b._title?1:0)})},setTitle:function(a){var b=this;this._setContent("_title",a,function(){b._title=b.build({tagName:"h2",content:a}),b.insertChild(b._title,0)})},handleAction:function(){this.hide()},show:function(){if(!this._visible){this._visible=!0;var a=this.getNode(),b=a.style;b.cssText="display: block; visibility: hidden; height: auto; width:"+this.getWidth(),a.parentNode||this.placeIn(document.body);var c=this.getDesiredHeight();this.updateHeight&&this.updateHeight(c),this.setStyle({display:"block",height:c,visibility:"visible",bottom:"-"+c+"px",width:this.getWidth()||"100%"});var d=this.findRef("actionContainer").getChildViews().length>1;this[d?"addClass":"removeClass"]("bolt-action-sheet-multi-col");var e=this;setTimeout(function(){e.setMode("visible","state")},0)}},getDesiredHeight:function(){return this.getRect().height},toggle:function(){this._visible?this.hide():this.show()}}});b.ActionSheet=h}}),require.define({"views/button":function(a,b,c){function i(a){return a==="special"?"uiButtonSpecial":"uiButtonConfirm"}__DEV__=0;var d=a("util"),e=a("view").View,f=a("javelin/dom"),g=a("mixins/actionable").Actionable,h=a("javelin/core").createClass({name:"Button",extend:e,properties:{tagName:"span",value:""},mixins:[g],members:{render:function(){this.setLayout({tagName:"span",className:"bolt-button-inner",childViews:[{ref:"button",tagName:"input",type:"button",className:"uiButtonInput"}]}),f.alterClass(this.getNode(),"uiButton uiButtonNoText",!0),this.actionableInit()},setLarge:function(a){this.large=a,f.alterClass(this.getNode(),"uiButtonLarge",a)},getLarge:function(a){return this.large},setValue:function(a){this.refs.button.getNode().value=a},getValue:function(){return this.refs.button.getNode().value},setUse:function(a){f.alterClass(this.getNode(),i(this.use),!1),this.use=a,f.alterClass(this.getNode(),i(this.use),!0);return this},getUse:function(){return this.use},setDown:function(a){a?this.addClass("bt-button-down"):this.removeClass("bt-button-down")}}});b.Button=h}}),require.define({"views/buttontooltip":function(a,b,c){__DEV__=0;var d=a("util"),e=a("views/layout/hbox").HBox,f=a("views/simpletooltip").SimpleTooltip,g=a("javelin/core").createClass({name:"ButtonTooltip",extend:f,events:["choose"],properties:{labels:"",value:""},members:{render:function(){f.prototype.render.call(this);var a=this.build({view:"HBox",ref:"container"});this.appendChild(a)},setLabels:function(a){this.setProperty("labels",a),this.findRef("container").setLayout(d.map(a||[],this.generateOptionButton,this),this)},generateOptionButton:function(a){return{childViews:[{view:"Button",owner:this,onclick:"handleSelect",value:a,ref:"button-"+a}]}},handleSelect:function(a){var b=this.refForEvent(a);this.setValue(b.getValue()),this.hide(),this.invoke("choose")}}});b.ButtonTooltip=g}}),require.define({"views/clearabletextinput":function(a,b,c){__DEV__=0,a("views/textinput"),a("views/closeicon");var d=a("util"),e=a("javelin/dom"),f=a("view"),g=a("views/layout/hbox").HBox,h=a("javelin/core").createClass({name:"ClearableTextInput",extend:g,properties:{label:"",clearable:!0},delegateProperties:{input:["size","value","select","placeholder","maxlen","disabled","readonly"]},events:["clear","change"],members:{render:function(){g.prototype.render.apply(this);var a=this.build([{flex:1,className:"bolt-clearable-text-input",childViews:[{view:"TextInput",ref:"input",onfocus:"handleFocus",onblur:"handleBlur"}]},{className:"bolt-clearable-text-icon",childViews:[{view:"CloseIcon",ref:"button",action:"handleClear"}]}]);this.addClass("inactive"),d.forEach(a,this.appendChild,this),this.delayedFocus=d.bind(this.delayedFocus,this),this.setActiveStatus=d.bind(this.updateActive,this,!0),this.setInactiveStatus=d.bind(this.updateActive,this,!1),this.focus=d.bind(this.focus,this),this.listen(f.touchEvents.TOUCHSTART,this.delayedFocus)},focus:function(){this.findRef("input").focus()},delayedFocus:function(){setTimeout(this.focus,50)},handleClear:function(a){this.isActive()&&(this.setValue(""),this.invoke("clear")),this.focus()},handleFocus:function(a){this.clearTimer(),this._timer=setTimeout(this.setActiveStatus,200)},handleBlur:function(a){this.clearTimer(),this._timer=setTimeout(this.setInactiveStatus,200)},updateActive:function(a){this.clearTimer(),e.alterClass(this.getNode(),"active",a),e.alterClass(this.getNode(),"inactive",!a)},isActive:function(){return d.hasClass(this.getNode(),"active")},clearTimer:function(){this._timer&&(clearTimeout(this._timer),this._timer=null)}}});b.ClearableTextInput=h}}),require.define({"views/closeicon":function(a,b,c){__DEV__=0;var d=a("mixins/actionable").Actionable,e=a("view"),f=a("javelin/core").createClass({name:"CloseIcon",extend:e.View,properties:{tagName:"span"},mixins:[d],members:{render:function(){e.View.prototype.render.call(this),this.actionableInit()}}});b.CloseIcon=f}}),require.define({"views/image":function(a,b,c){__DEV__=0;var d=a("view").View,e=a("util/image_queue");b.Image=a("javelin/core").createClass({name:"Image",extend:d,properties:{tagName:"img",queued:!0},construct:function(a){d.call(this,a)},setup:function(a){d.prototype.setup.call(this,a),this.getNode().onload=this.handleLoad},handleLoad:function(a){a.target.style.visibility="visible"},setSrc:function(a){this.getQueued()&&a?(this.setProperty("src",a),this.getNode().style.visibility="hidden",e.add(a,this.handleQueueCallback,this),this.enqueued=!0):d.prototype.setSrc.call(this,a)},handleQueueCallback:function(a,b){this.enqueued=!1,a==this.getProperty("src")&&d.prototype.setSrc.call(this,a)},destroy:function(){this.enqueued&&e.remove(this.getProperty("src"),this.handleQueueCallback,this),d.prototype.destroy.call(this)}})}}),require.define({"views/labelledtextinput":function(a,b,c){__DEV__=0,a("views/clearabletextinput"),a("views/closeicon"),a("views/buttontooltip"),a("views/button");var d=a("util"),e=a("view"),f=a("model").Model,g=a("views/layout/hbox").HBox,h=a("javelin/core").createClass({name:"LabelledTextInput",extend:g,construct:function(a){var b=a.labelOptions;delete a.labelOptions,g.call(this,a),this.setLabelOptions(b)},properties:{label:"",clearable:!0,labelOptions:null},delegateProperties:{input:["size","value","select","placeholder","maxlen","disabled"],labelview:[{alias:"label",name:"innerHTML"}]},events:["labelclick"],members:{render:function(){g.prototype.render.apply(this);var a=this.build([{className:"bolt-labelled-text-label",sigil:"touchable",onclick:"handleLabelClick",ref:"labelcontainer",childViews:[{ref:"labelview",className:"bolt-label"},{ref:"tooltip",view:"ButtonTooltip",onchoose:"handleLabelOptionSelect"}]},{flex:1,className:"bolt-labelled-text-input-wrapper",childViews:[{view:"ClearableTextInput",ref:"input"}]}]);this.addClass("inactive"),d.forEach(a,this.appendChild,this)},setErrorState:function(a,b){a=="value"&&g.prototype.setErrorState.call(this,a,b)},handleLabelOptionSelect:function(a,b){this.setLabel(this.findRef("tooltip").getValue()),this.findRef("tooltip").hide()},setLabelOptions:function(a){this.findRef("tooltip").setLabels(a),a&&a.length&&this.findRef("labelcontainer").addClass("bolt-touchable-view")},handleLabelClick:function(a){this.invoke("labelclick",a),this.findRef("input").focus();var b=this.findRef("tooltip").getLabels();b&&b.length&&this.findRef("tooltip").toggle()}}});b.LabelledTextInput=h}}),require.define({"views/layout/boxbase":function(a,b,c){__DEV__=0;var d=a("javelin/core"),e=a("view").View,f=d.createClass({name:"BoxBase",extend:e,members:{className:"bolt-box-layout",orientation:"",render:function(){this.setStyle({display:"-webkit-box",webkitBoxOrient:this.orientation})}}});b.BoxBase=f}}),require.define({"views/layout/hbox":function(a,b,c){__DEV__=0;var d=a("javelin/core"),e=a("view"),f=a("views/layout/boxbase").BoxBase,g=d.createClass({name:"HBox",extend:f,members:{orientation:"horizontal"}});b.HBox=g}}),require.define({"views/layout/vbox":function(a,b,c){__DEV__=0;var d=a("javelin/core"),e=a("view"),f=a("views/layout/boxbase").BoxBase,g=d.createClass({name:"VBox",extend:f,members:{orientation:"vertical"}});b.VBox=g}}),require.define({"views/link":function(a,b,c){__DEV__=0;var d=a("view").View,e=a("mixins/actionable").Actionable,f=a("javelin/core").createClass({name:"Link",extend:d,delegateProperties:{label:[{alias:"label",name:"content"}]},mixins:[e],members:{render:function(){this.setLayout({ref:"label",content:""}),this.addClass("bolt-touchable-view"),this.actionableInit()}}});b.Link=f}}),require.define({"views/pageheader":function(a,b,c){__DEV__=0;var d=a("javelin/core"),e=a("util"),f=a("view").View,g=a("views/layout/hbox").HBox,h=d.createClass({name:"PageHeader",extend:f,properties:{label:"Default"},delegateProperties:{label:[{alias:"label",name:"innerHTML"}]},members:{setup:function(a){f.prototype.setup.call(this,a),this.setAdditionalClasses(["bolt-page-header","bt-bar"])},render:function(){this.setLayout([{view:"HBox",childViews:[{ref:"left",additionalClasses:"bolt-page-header-left",flex:1},{flex:8},{ref:"right",additionalClasses:"bolt-page-header-right",flex:1}]},{ref:"label",additionalClasses:"bolt-page-header-label"}]),this.addClass("bolt-page-header")},addView:function(a,b){this.refs[b||"right"].setChildViews([a])},getView:function(a){return this.refs[a||"right"].getChildViews()[0]},setChildViews:function(a){var b="left";this.refs.left.setChildViews([]),this.refs.right.setChildViews([]);for(var c=0;c<a.length&&c<2;c++)a[c].headerAlign&&(b=a[c].headerAlign,delete a[c].headerAlign),this.addView(a[c],b),b="right"}}});b.PageHeader=h}}),require.define({"views/scene":function(a,b,c){__DEV__=0;var d=a("view"),e=a("util"),f=a("javelin/core"),g=d.View,h=a("views/button").Button,i=f.createClass({name:"Scene",extend:g,properties:{stack:null,modal:null,header:null,title:"Scene"},members:{useHeader:function(){return!0},setTitle:function(a){this.setProperty("title",a);var b=this.getHeader();b&&b.setLabel(a)},getHeaderLeft:function(){if(this.getStack().getDepth()>0)return{view:h,value:"Back",onclick:e.bind(this.getStack().pop,this.getStack())};return null},getHeaderRight:function(){return null},prepare:function(){},activate:function(a){},deactivate:function(){},startTransition:function(a){},endTransition:function(a){}}});b.Scene=i,d.Scene=i}}),require.define({"views/scene_stack":function(a,b,c){__DEV__=0;var d=a("javelin/core"),e=a("view"),f=a("util"),g=a("javelin/dom"),h=e.View,i=a("views/layout/vbox").VBox,j=a("views/pageheader").PageHeader,k=600,l=d.createClass({name:"SceneStack",extend:h,construct:function(a){h.call(this,a),this.scenes=[]},properties:{inTransition:!1,hideInactiveScene:!1,disableHeaders:!1},members:{getDepth:function(){return this.scenes.length},push:function(a,b){b=b||{};if(!this.getInTransition()){this.setInTransition(!0),a=this.build(a),a.setStack(this);var c=this.insertScene(a,b),d=a.prepare();d&&d.addCallback?d.addCallback(f.bind(function(){this.setWrapperVisibility(c,!0),this.pushPrepareComplete(a,c,b)},this)):(this.setWrapperVisibility(c,!0),this.pushPrepareComplete(a,c,b))}},pushModal:function(a,b){a.modal=!0,this.push(a,b)},pop:function(a,b){this.getInTransition()||(this.setInTransition(!0),this.scenes[0].deactivate(),this.getDepth()>1&&this.scenes[1].activate(a),this.popActivationComplete(b||{}))},popTo:function(a,b,c){var d;for(var e=this.scenes.length-2;e>0;e--)if(!a||a!=this.scenes[e].getDeclaredClass())d=this.scenes.splice(e,1)[0],d.setStack(null),this.removeChild(this.getChildViews()[e]),e--;if(this.getDepth()>1){this.pop(b,c);return!0}return!1},insertScene:function(a,b){this.getDepth()>0&&this.scenes[0].deactivate(),b=b||{};var c=[],d=[];if(!this.getDisableHeaders()&&a.useHeader()){var e=a.getHeaderLeft(),f=a.getHeaderRight(),g=a.getTitle();e&&(e.headerAlign="left")&&c.push(e),f&&(f.headerAlign="right")&&c.push(f),d.push({view:"PageHeader",label:g,ref:"header",childViews:c})}d.push(a);var h=b.transition||"slide",j="bt-scene-stack-wrapper "+h;a.setFlex(1);var k={},l=this.build({view:i,className:j,childViews:d},k),m=k.refs?k.refs.header:null;m&&a.setHeader(m),this.setWrapperVisibility(l,!1),this.insertChild(l),this.scenes.unshift(a);return l},setWrapperVisibility:function(a,b){a.setStyle({visibility:b?"visible":"hidden"})},pushPrepareComplete:function(a,b,c){a.activate();if(this.getDepth()>1&&!c.noTransition){if(!a.getModal()){this.scenes[1].startTransition("out");var d=this.getChildViews();d[d.length-2].addClass("out").removeClass("in")}a.startTransition("in");var e=this;b.getNode().addEventListener("webkitAnimationEnd",function(){b.getNode().removeEventListener("webkitAnimationEnd",arguments.callee),e.pushTransitionComplete(),c.onComplete&&c.onComplete()},!1),b.addClass("in")}else this.setInTransition(!1)},pushTransitionComplete:function(){this.scenes[1].endTransition("out"),this.scenes[0].endTransition("in"),this.getHideInactiveScene()&&(this.scenes[1].getNode().parentNode.style.display="none");var a=this.getChildViews();a[a.length-1].removeClass("in"),this.setInTransition(!1)},popActivationComplete:function(a){var b,c=a.noTransition;this.getDepth()>1&&(this.scenes[1].getNode().parentNode.style.display="-webkit-box",this.scenes[0].getModal()||(this.scenes[1].startTransition("in.reverse"),b=this.getChildViews(),b[b.length-2].removeClass("out"),c||b[b.length-2].addClass("in reverse"))),this.scenes[0].startTransition("out.reverse"),b=this.getChildViews();if(!c){var d=b[b.length-1],e=this;d.getNode().addEventListener("webkitAnimationEnd",function(){d.getNode().removeEventListener("webkitAnimationEnd",arguments.callee),e.popTransitionComplete(),a.onComplete&&a.onComplete()},!1),d.addClass("out reverse")}else this.popTransitionComplete(),a.onComplete&&a.onComplete()},popTransitionComplete:function(){var a=this.getChildViews();this.getDepth()>1&&(this.scenes[1].endTransition("in.reverse"),a[a.length-2].removeClass("in").removeClass("reverse")),this.scenes[0].endTransition("out.reverse"),this.scenes[0].setStack(null),this.removeChild(a[a.length-1]),this.scenes.shift(),this.setInTransition(!1)}}});b.SceneStack=l,e.SceneStack=l}}),require.define({"views/scroll_view":function(a,b,c){__DEV__=0,a("views/layout/vbox");var d=a("javelin/core"),e=a("javelin/dom"),f=a("util"),g=a("builder").build,h=a("view").View,i=a("iscroll").iScroll,j=d.createClass({name:"ScrollView",extend:h,properties:{useScrollbar:!0},members:{SCROLL_CHECK_INTERVAL:10,TIMER_NOOP_KILL_THRESHOLD:250,flex:1,render:function(){var a=this.getNode();a.style.position="relative",e.alterClass(a,"wrapper",!0),this._scroller||(this._scroller=this.build({className:"scroller",style:{position:"relative"}}),e.appendContent(a,this._scroller.getNode())),this.matrix=new WebKitCSSMatrix;return this},destroy:function(){h.prototype.destroy.call(this),this.scrolling=!1,clearTimeout(this.scrollTimeout),this._iScroll&&this._iScroll.destroy()},onDocumentInsertion:function(){var a={onScrollEnd:f.bind(this.onScrollEnd,this),onScrollChange:f.bind(this.onScrollChange,this),onScrollStart:f.bind(this.onScrollStart,this)};this.options.iscroll&&(a=f.extend(a,this.options.iscroll)),this._iScroll=new i(this.getNode(),a),this._iScrollStyle=this._iScroll.scroller.style,this._scrollObserver=f.bind(this.observeScroll,this)},observeScroll:function(){clearTimeout(this.scrollTimeout),this.matrix.setMatrixValue(window.getComputedStyle(this._iScroll.scroller,null).webkitTransform);var a,b,c=1,d=Math.abs(this.matrix.m41-(this.scrollX||0)),e=Math.abs(this.matrix.m42-(this.scrollY||0));if(d>c||e>c)a=this.scrollX=this.matrix.m41,b=this.scrollY=this.matrix.m42,this.onScroll(a,b);this.scrollY===this._lastScrollY?(this._timerNOOPCount=this._timerNOOPCount||0,this._timerNOOPCount++):this._timerNOOPCount=0,this._lastScrollY=this.scrollY,this.scrolling&&this._timerNOOPCount<this.TIMER_NOOP_KILL_THRESHOLD?this.scrollTimeout=setTimeout(this._scrollObserver,this.SCROLL_CHECK_INTERVAL):this._timerNOOPCount>=this.TIMER_NOOP_KILL_THRESHOLD&&console.log("killed a runaway timer in Bolt ScrollView")},onScrollStart:function(){this.scrolling=!0,this.observeScroll();var a=this.getOwner();a.didScrollStart&&a.didScrollStart(this)},onScroll:function(a,b){if(!this.isDestroyed){var c=this.getOwner();c.scrollViewDidScrollTo&&c.scrollViewDidScrollTo(this,a,b)}},onScrollChange:function(a,b){var c=this.getOwner();c&&c.willScrollToAnimated&&c.willScrollToAnimated(a,b)},onScrollEnd:function(){var a=this.getOwner();a&&a.didScrollTo&&a.didScrollTo(this._iScroll.x,this._iScroll.y,this),this.scrolling=!1,clearTimeout(this.scrollTimeout)},setHeight:function(a){h.prototype.setHeight.call(this,a),this.refresh()},scrollTo:function(a,b,c,d){this._iScroll.scrollTo(a,b,c,d),this.onScrollChange(a,b)},scrollToPageX:function(a,b){this._iScroll.scrollToPage(a,0,b)},getPageXNum:function(){return this._iScroll.currPageX},getDirX:function(){return this._iScroll.dirX},setContentHeight:function(a){this._scroller.getNode().style.height=a+"px"},setUseScrollbar:function(a){e.alterClass(this.getNode(),"bolt-hidden-scrollbar",!a)},maxScrollY:function(){return-this._iScroll.maxScrollY},scrollHeight:function(){return this._iScroll.scrollerH},appendChild:function(a){this.getChildViews().push(a),this._scroller.appendChild(a),f.debounce(this.refresh,250)();return this},refresh:function(){this._iScroll&&this._iScroll.refresh()},clear:function(){f.invoke(this.getChildViews(),"destroy"),this._scroller.getNode().innerHTML=""},coords:function(){if(!this._iScroll)return[0,0];return[this._iScroll.x,this._iScroll.y]}}});b.ScrollView=j}}),require.define({"views/scrubber":function(a,b,c){__DEV__=0;var d=a("util"),e=a("view"),f=e.View,g=a("javelin/core").createClass({extend:f,name:"Scrubber",properties:{characters:"abcdefghijklmnopqrstuvwxyz#",caps:!0},members:{render:function(){var a=this.getCaps()?"toUpperCase":"toLowerCase";this.getCaps()&&this.addClass("bolt-upper-case"),this.setBoxOrientation(this.getBoxOrientation()||"vertical"),this.handleTouch=d.bind(this.handleTouch,this);var b=e.touchEvents,c=[],f=this.getCharacters(),g=f.length,h;for(var i=0;i<g;i++)h=f.substr(i,1).toLowerCase(),c.push({content:h,flex:1,metadata:{letter:h}});this.addClass("bolt-"+this.getBoxOrientation()),this.listen([b.TOUCHSTART],d.bind(this.handleTouchStart,this)),this.listen([b.TOUCHEND],d.bind(this.handleTouchEnd,this)),this.setLayout(c),e.hasTouch?this.listen([b.TOUCHMOVE],this.handleTouch,this):this.getNode().onmousemove=this.handleTouch},handleTouchStart:function(a){var b=this.getRawEvent(a),c=b.target;c&&c.nodeType===3&&(c=c.parentNode);if(!!c.getAttribute("data-letter")){var e=c.offsetHeight;this.touchPos={x:b.pageX,y:b.pageY,nodeIndex:d.indexOf(this.getNode().childNodes,c)},this.letterHeight=c.offsetHeight,this.addClass("touched"),this.handleTouch(a)}},handleTouchEnd:function(a){this.touchPos=null,this.removeClass("touched");var b=this.getOwner();b&&b.onScrubEnd&&b.onScrubEnd(this)},handleTouch:function(a){if(!this.touchPos)this.handleTouchStart(a);else{a.kill(),this.addClass("touched");var b=this.getOwner(),c=this.getRawEvent(a),d=this.touchPos.y-c.pageY,e=this.getNode().childNodes,f=Math.max(0,Math.min(e.length-1,Math.round(this.touchPos.nodeIndex-d/this.letterHeight))),g=e[f],h=g.getAttribute("data-letter");b&&b.onScrub&&h&&b.onScrub(h)}},getRawEvent:function(a){var b=a.getRawEvent?a.getRawEvent():a;b.touches&&(b=b.touches[0]);return b}}});b.Scrubber=g}}),require.define({"views/simpletooltip":function(a,b,c){__DEV__=0;var d=a("util"),e=a("javelin/stratcom"),f=a("view").View,g=a("javelin/core").createClass({name:"SimpleTooltip",extend:f,construct:function(a){f.call(this,a),e.listen("modalopen",null,d.bind(this.handleModalOpen,this))},members:{style:{display:"none"},handleModalOpen:function(a){a.getData()!==this&&this.hide()},render:function(){f.prototype.render.call(this),this.hide()},show:function(){e.invoke("modalopen",null,this),this.getNode().style.display="inherit"},hide:function(){this.getNode().style.display="none"},toggle:function(){this[this.getNode().style.display=="none"?"show":"hide"]()}}});b.SimpleTooltip=g}}),require.define({"views/table":function(a,b,c){__DEV__=0;var d=a("javelin/core"),e=a("view"),f=a("util"),g=a("javelin/dom"),h=a("javelin/vector"),i=a("view").View,j=a("views/scroll_view").ScrollView,k=window.$i||{stop:function(){},start:function(){}},l=d.createClass({name:"Table",extend:i,properties:{selectable:!0,progressive:!0,scrollbar:!0,fixedRowHeight:0,disableClear:!1,packSize:3,postScrollBuffer:0,bufferSize:0,debug:!0},members:{_packs:[],render:function(){this.setBoxOrientation("vertical"),this._layout=this.setLayout([{view:"ScrollView",ref:"scrollview",owner:this,style:{height:"100%"},flex:1},{className:"bt-loading-view",content:'<div class="bt-loading-text"><div class="bt-loading-indicator"></div>loading...</div>',ref:"loadingShield",style:{fontSize:"18px"},flex:1}]),this.setStyle({height:"100%"}),this.scrollView=this.refs.scrollview,this.scrollView.onScroll=f.bind(this.onScroll,this),this.loadingShield=this.refs.loadingShield},onScroll:function(a,b){b=-b,this._log("table did scroll",a,b),this._log("range:",this.lastY,b),this._tableWantsDataInRange(this.lastY||0,b,this.getBufferSize()),this._removePacksNotInRange(this._lastRenderedRange),this.lastY=b},setup:function(a){i.prototype.setup.call(this,a);var b=e.touchEvents;this.listen([b.TOUCHSTART],f.bind(this._onTouchStart,this)),this.listen([b.TOUCHEND],f.bind(this._onTouchEnd,this)),e.hasTouch?this.listen([b.TOUCHMOVE],f.bind(this._onTouchMove,this)):this.getNode().onmousemove=f.bind(this._onTouchMove,this)},refresh:function(){this._packs=[];if(!!this.scrollView){var a=this._getViewportRange();this.cleanup(),delete this.totalHeight,this._tableWantsDataInRange(a[0],a[1],this.getPostScrollBuffer()),this.scrollView.refresh()}},cleanup:function(){this.scrollView.clear()},setLoading:function(a){this._loading=a,a?this.addClass("bt-loading"):this.removeClass("bt-loading")},setScrollbar:function(a){this[a?"removeClass":"addClass"]("bolt-table-no-scrollbar")},scrollTo:function(a,b,c){this.scrollView.scrollTo(0,a,b,c)},scrollToEnd:function(a){this.totalHeight<this.visibleHeight()||this.scrollTo(this.visibleHeight()-this.totalHeight,a)},visibleHeight:function(){return this.getRect().height},_onTouchStart:function(a){var b=a.getRawEvent();this._startX=b.clientX,this._startY=b.clientY;var c=this.findPathToParentWithClass(a.getTarget(),"bt-table-row-pack");this._moved=!1,this._canceled=!1;if(c&&c[c.length-2]){this._touchDownRow=c[c.length-2];var d=this;this._touchDownTimer=setTimeout(function(){d._touchDownRow&&d.getSelectable()&&g.alterClass(d._touchDownRow,"bt-active",!0)},50)}},_onTouchCancel:function(){this._canceled=!0,this._deselectRow()},_onTouchMove:function(){this._moved=!0,this._deselectRow()},_deselectRow:function(){this._touchDownRow&&(this.getSelectable()&&g.alterClass(this._touchDownRow,"bt-active"),clearTimeout(this._touchDownTimer),delete this._touchDownRow)},_onTouchEnd:function(a){clearTimeout(this._touchDownTimer),this._touchDownRow&&this._isTap(a)&&(this._onTap(this._touchDownRow),this._clearSelection())},_clearSelection:function(){clearTimeout(this._touchDownTimer),this._touchDownRow&&(this.getSelectable()&&g.alterClass(this._touchDownRow,"bt-active"),delete this._touchDownRow)},_onTap:function(a,b){this.getOwner()&&this.getOwner().onRowTap&&this.getOwner().onRowTap(a,b)},_isTap:function(a){return!this._moved&&!this._canceled},_getViewportRange:function(){var a=-this.scrollView.coords()[1],b=a+this.scrollView.getRect().height;this._log("refreshing range:",[a,b]);return[a,b]},_iterateData:function(a){var b=0,c=0,d=this.getOwner(),e=d.numberOfSections?d.numberOfSections():1,f=this.getFixedRowHeight();for(var g=0;g<e;g++){c=d.heightForSectionHeader?d.heightForSectionHeader(g):0,res=a.call(this,b,b+c,g);if(res===!1)return;b+=c;var h=d.numberOfRowsInSection(g);for(var i=0;i<h;i++){c=f||d.heightForRowInSection(i,g),res=a.call(this,b,b+c,g,i);if(res===!1)return;b+=c}}},tableWantsDataAtIndex:function(a,b){var c,d=arguments.length<2;this._iterateData(function(e,f,g,h){c=e;if(a==g&&(d||b===h))return!1}),this._tableWantsDataInRange(c,c+this.visibleHeight(),1),this.scrollTo(-1*c,0)},_deriveScrollHeight:function(){if(this.totalHeight)return this.totalHeight;this.totalHeight=this.totalHeight||0,this._iterateData(function(a,b,c,d){this.totalHeight=b}),this.scrollView.setContentHeight(this.totalHeight);return this.totalHeight},_packsFillRange:function(a,b,c){if(a.length===0)return!1;var d=a[0],e=a[a.length-1];return d.from<=b&&e.to>=c?!0:!1},_isInRange:function(a,b,c){if(a.from<=b&&a.to>=b)return!0;if(a.from>=b&&a.to<=c)return!0;if(a.from>=b&&a.from<=c)return!0;return!1},_packsForRange:function(a,b){this._packs=this._packs||[];var c=[],d=0,e=0;for(var f=0;f<this._packs.length;f++){var g=this._packs[f];this._isInRange(g,a,b)&&(c.push(g),d===null&&(d=g.from),e=g.to)}if(this._packsFillRange(c,a,b)){this._log("returning early with packs");return c}var h,i=this.getPackSize(),j=this.getOwner();this._iterateData(function(a,d,f,g){var k={from:a,to:d};if(this._isInRange(k,e,b)){if(!h||h.length>=i)h=[],this._packs.push(h),c.push(h);var l;typeof g=="undefined"?l=j.sectionHeaderAtIndex&&j.sectionHeaderAtIndex(f):l=j.cellForRowInSection&&j.cellForRowInSection(g,f),l&&(typeof h.from=="undefined"&&(h.from=a),h.to=d,h.push(l));if(d>b)return!1}return!0});return c},_renderPacks:function(a){k.start("table:_renderPacks");var b=this;for(var c=0;c<a.length;c++){pack=a[c];if(!pack.view){var d;typeof pack[0]=="string"?d=b.build({content:pack.join(""),className:"bt-table-row-pack bt-hwa"}):d=b.build({childViews:pack,className:"bt-table-row-pack bt-hwa"}),d.getNode().style.cssText="width:100%;position:absolute;top:"+pack.from+"px",pack.view=d}pack.view.getNode().parentNode||b.scrollView.appendChild(pack.view)}k.stop("table:_renderPacks")},_tableWantsDataInRange:function(a,b,c){k.start("table:_tableWantsDataInRange");var d=this._deriveScrollHeight(),e=this._constrainToBounds(a,b,d,c);a=e[0],b=e[1],this._log("from:"+a+" to:"+b);var f=this._packsForRange(a,b);this._renderPacks(f),this._lastRenderedRange=[a,b],k.stop("table:_tableWantsDataInRange")},_removePacksNotInRange:function(a){k.start("table:removePacksNotInRange");for(var b=0;b<this._packs.length;b++){var c=this._packs[b],d=a[0],e=a[1];!this._isInRange(c,d,e)&&c.view&&c.view.remove()}k.stop("table:removePacksNotInRange")},_constrainToBounds:function(a,b,c,d){if(!this.getProgressive()){a=0,b=Infinity,console.log("rendering range:",[a,b]);return[a,b]}d=d||1;var e=this.scrollView.getRect().height;b<e&&(b=e),a=a-e*d,b=b+e*d,c&&b>c&&(b=c),a<0&&(a=0),a=Math.round(a),b=Math.round(b);return[a,b]},_log:function(){this.getDebug()&&console.log.apply(console,arguments)},_convertCoordinatesToRange:function(a,b){var c=this.scrollView.coords()[1],d,e,f=this.scrollView.getRect();b>c?(d=-b,e=-c+f.height):(d=-c,e=-b+f.height);return[d,e]},willScrollToAnimated:function(a,b){},didScrollTo:function(a,b){}}});b.Table=l}}),require.define({"views/table_view":function(a,b,c){__DEV__=0;var d=a("javelin/core"),e=a("util"),f=a("view"),g=a("view").View,h=a("views/scroll_view").ScrollView,i=a("mixins/has_event_listeners").HasEventListeners,j=b.TableView=d.createClass({name:"TableView",extend:g,mixins:[i],declare:function(a){return{eventListeners:{"touchstart,touchend,touchmove .bt-table-view-cell":"onCellTouch"},debug:!1,style:{height:"100%"},flex:1,boxOrientation:"vertical",bufferSize:0,sectioned:!0,stickySectionHeaders:!1,fixedSectionHeaderHeight:0,childViews:[{ref:"floatingSection",owner:this,additionalClasses:"bolt-table-view-floating-section"},{view:"ScrollView",owner:this,ref:"scrollView",flex:1},{additionalClasses:"bt-table-loading-view",ref:"loadingView",style:{display:"none"},owner:this,childViews:[{content:"Loading...",additionalClasses:"bt-loading-view-text"}]}]}},ready:function(){this.itemList=[],this.owner=this.getOwner(),this.scrollView=this.findRef("scrollView"),this.bufferSize=this.getBufferSize(),this.y=0,this.topSectionIdx=-1,this.sectionHeaderContents=[],this.lastY=0,this.lastX=0,this.loadingView=this.findRef("loadingView"),this.getFixedRowHeight&&(this.fixedRowHeight=this.getFixedRowHeight())},setLoading:function(a){if(a){var b=this.calculateViewPort().height+"px";this.loadingView&&this.loadingView.show()}else this.loadingView&&this.loadingView.hide()},show:function(){this.setStyle({display:"-webkit-box"});var a=this;setTimeout(function(){a.refresh(),a.moveToTop()},100)},destroy:function(){this.superKlass.prototype.destroy.call(this)},clearSelection:function(){this.selectedCell&&this.selectedCell.setSelected(!1)},onDocumentInsertion:function(){this.isInserted=!0;var a=this;setTimeout(function(){a.refresh()},10)},onCellTouch:function(a,b){var c=b.getAttribute("data-item-index");this.log(a.type);var d=this.itemList[c],f=d&&d.view,g=this.getOwner();if(!!f)switch(a.type){case"touchstart":this._cellSelectTimer=setTimeout(e.bind(function(){this.clearSelection(),f.setSelected(!0),this.selectedCell=f},this),50);break;case"touchend":clearTimeout(this._cellSelectTimer),f.getSelected()&&g.cellSelectedAtRowInSection(this,d.row,d.section,f);break;case"touchmove":clearTimeout(this._cellSelectTimer),this.clearSelection();break;default:}},refresh:function(){this.clear(),this.buffer()},scrollViewDidScrollTo:function(a,b,c){this.x=-b,this.y=-c;var d=Math.abs(this.y-this.lastY);d>20&&(this.buffer(),this.lastY=c,this.lastX=b)},didScrollTo:function(a){var b=this.getOwner();b.didScrollEnd&&b.didScrollEnd(this)},didScrollStart:function(a){var b=this.getOwner();b.didScrollStart&&b.didScrollStart(this)},clear:function(){delete this.viewPort,delete this.scrollHeight,delete this.sectionCount,delete this.rowCounts,delete this.lastHeadPtr,delete this.lastTailPtr,this.clearSelection&&this.clearSelection(),e.forEach(this.itemList||[],function(a){this.reapItem(a)},this)},buffer:function(){this.calculateBuffer(this.y),this.viewPort.height===0?(delete this.viewPort,delete this.scrollHeight):(this.lastHeadPtr!==this.headPtr||this.lastTailPtr!==this.tailPtr)&&this.renderBuffer(this.headPtr,this.tailPtr,this.lastHeadPtr,this.lastTailPtr)},calculateBuffer:function(a){this.viewPort||this.calculateViewPort(),this.scrollHeight||this.calculateScrollHeight(),this.viewPortHeadPtr=this.findItemIndex(Math.max(a,0)),this.viewPortTailPtr=this.findItemIndex(Math.min(a+this.viewPort.height,this.scrollHeight)),this.headPtr=Math.max(this.viewPortHeadPtr-this.bufferSize,0),this.tailPtr=Math.min(this.viewPortTailPtr+this.bufferSize,this.itemList.length-1)},moveToSection:function(a,b){var c=this.sectionIndices[a];a=this.itemList[c],this.y=a.start,e.forEach(this.itemList,this.reapItem,this),delete this.lastHeadPtr,delete this.lastTailPtr,this.buffer(),this.scrollView.scrollTo(0,-this.y,b||0,!1)},moveToEnd:function(a){var b;this.scrollHeight<this.viewPort.height?b=0:b=this.scrollHeight-this.viewPort.height,a===0?(this.y=b,this.refresh(),this.scrollView.scrollTo(0,-b,0,!1)):this.scrollView.scrollTo(0,-b,a||0,!1)},moveToTop:function(a){this.scrollView.scrollTo(0,0,a||0,!1)},renderBuffer:function(a,b,c,d){var e;if(c===undefined&&d===undefined)e="refresh";else if(b>d||a>c)e="down";else if(b<d||a<c)e="up";var f;switch(e){case"refresh":for(f=a;f<=b;f++)this.renderItem(this.itemList[f],f);break;case"down":for(f=c;f<a;f++)this.reapItem(this.itemList[f]);for(f=d+1;f<=b;f++)this.renderItem(this.itemList[f],f);break;case"up":for(f=d;f>b;f--)this.reapItem(this.itemList[f]);for(f=c-1;f>=a;f--)this.renderItem(this.itemList[f],f);break;default:}if(this.getStickySectionHeaders()){var g=0;if(this.topSectionIdx>-1){var h=this.itemList[this.sectionIndices[this.topSectionIdx]],i;if(h.start<this.y)for(f=g;f<this.sectionIndices.length;f++){i=this.itemList[this.sectionIndices[f]].start;if(i<this.y)g=f;else break}else for(f=this.topSectionIdx;f>-1;f--){i=this.itemList[this.sectionIndices[f]].start;if(i<this.y){g=f;break}}}if(g!=this.topSectionIdx&&this.sectionHeaderContents.length){var j=this.findRef("floatingSection"),k=this.sectionHeaderContents[g];if(!k){var l=this.sectionIndices[g],m=this.renderItem(this.itemList[l],l);this.sectionHeaderContents[g]=k=m.getNode().outerHTML,this.reapItem(m)}this.topSectionIdx=g,j.setInnerHTML(k),j.getNode().firstChild.style.webkitTransform=""}}this.lastHeadPtr=this.headPtr,this.lastTailPtr=this.tailPtr},renderItem:function(a,b){if(a.view)return null;a.hasOwnProperty("row")?(f=this.owner.cellForRowInSection(this,a.row,a.section),f.setMetadata({"item-index":b})):(f=this.owner.viewForHeaderInSection(this,a.section),f.setMetadata({"item-index":b}),this.getStickySectionHeaders()&&!this.sectionHeaderContents[a.section]&&(this.sectionHeaderContents[a.section]=f.getNode().outerHTML)),f.setStyle({webkitTransform:"translate3d(0,"+a.start+"px,0)"}),a.view=f,f.getNode().parentNode||this.scrollView.appendChild(f);return f},reapItem:function(a){var b=a.view;!b||(delete a.view,a.hasOwnProperty("row")?this.enqueueReusableCellWithIdentifier(b,b.getReuseIdentifier()):this.enqueueReusableSectionHeaderWithIdentifier(b,b.getReuseIdentifier()),b.setStyle({webkitTransform:"translate3d(-5000px,0,0)"}),b.setMetadata({"item-index":"queued"}))},findItemIndex:function(a){var b=this.itemList.length;low=0;var c;while(low<b){mid=low+b>>1,c=this.itemList[mid];if(c.start<=a&&c.end>=a)return mid;a<c.end?b=mid:low=mid+1}return null},calculateScrollHeight:function(){this.itemList=[],this.sectionIndices=[],this.scrollHeight=0,this.getSectioned()?this.sectionCount=this.hasOwnProperty("sectionCount")?this.sectionCount:this.owner.numberOfSections(this):this.sectionCount=1,this.rowCounts=this.rowCounts||{};var a=0,b,c;for(var d=0;d<this.sectionCount;d++){b={section:d,row:e,start:this.scrollHeight},c=this.getFixedSectionHeaderHeight()||(this.owner.heightForSectionHeader?this.owner.heightForSectionHeader(this,d):0),c>0&&(b={section:d,start:this.scrollHeight},this.scrollHeight+=c,b.end=this.scrollHeight,this.sectionIndices[d]=this.itemList.length,this.itemList.push(b)),this.rowCounts[d]===undefined&&(this.rowCounts[d]=this.owner.numberOfRowsInSection(this,d));for(var e=0;e<this.rowCounts[d];e++)b={section:d,row:e,start:this.scrollHeight},this.hasOwnProperty("fixedRowHeight")?this.scrollHeight+=this.fixedRowHeight:this.scrollHeight+=this.owner.heightForRowInSection(this,e,d),b.end=this.scrollHeight,this.itemList.push(b);this.absoluteIndex++}this.scrollView.setContentHeight(this.scrollHeight),this.scrollView.refresh()},setScrollbar:function(a){this[a?"removeClass":"addClass"]("bolt-table-no-scrollbar")},calculateViewPort:function(){if(!this.scrollView)return{height:0,width:0};this.viewPort=this.scrollView.getRect();return this.viewPort},dequeueReusableCellWithIdentifier:function(a){this.cells=this.cells||{},this.cells[a]=this.cells[a]||[];return this.cells[a].shift()},dequeueReusableSectionHeaderWithIdentifier:function(a){this.sectionHeaders=this.sectionHeaders||{},this.sectionHeaders[a]=this.sectionHeaders[a]||[];return this.sectionHeaders[a].shift()},enqueueReusableCellWithIdentifier:function(a,b){this.cells=this.cells||{},this.cells[b]=this.cells[b]||[];return this.cells[b].push(a)},enqueueReusableSectionHeaderWithIdentifier:function(a,b){this.sectionHeaders=this.sectionHeaders||{},this.sectionHeaders[b]=this.sectionHeaders[b]||[];return this.sectionHeaders[b].push(a)},log:function(a){this.getDebug()&&console.log.apply(console,arguments)}}),k=b.TableViewCell=d.createClass({name:"TableViewCell",extend:g,declare:function(a){return{selected:!1,reuseIdentifier:"cell"}},getSelected:function(){return this.getProperty("selected")},setSelected:function(a){this.setProperty("selected",a),a?this.addClass("bt-active"):this.removeClass("bt-active")}}),l=b.TableViewSectionHeader=d.createClass({name:"TableViewSectionHeader",extend:g,declare:function(a){return{reuseIdentifier:"section"}}})}}),require.define({"views/textinput":function(a,b,c){__DEV__=0;var d=a("javelin/core"),e=a("view"),f=a("javelin/dom"),g=d.createClass({name:"TextInput",extend:e.View,properties:{tagName:"input"},delegateProperties:{node:["size","value","select","placeholder","maxlen","disabled"]},members:{createDom:function(a){e.View.prototype.createDom.call(this,a),this.getNode().setAttribute("type","text")},focus:function(){this.getNode().focus()},setReadonly:function(a){var b=this.getNode();a?b.setAttribute("readonly","readonly"):b.removeAttribute("readonly")},getReadonly:function(){return this.getNode().getAttribute("readonly")=="readonly"}}});b.TextInput=g}}),require.define({"views/toggle":function(a,b,c){__DEV__=0;var d=a("javelin/core"),e=a("view"),f=a("util"),g=a("views/button").Button,h=e.View,i={toggleChoiceSelectedAtIndex:function(a,b){}},j=d.createClass({name:"Toggle",extend:h,properties:{choices:null,activeChoice:null},members:{setChoices:function(a){this.setProperty("choices",a),this._layout={view:"HBox",childViews:[]};var b=0;f.forEach(this.getChoices(),function(a){this._layout.childViews.push({view:"Button",ref:"choice"+b,value:a,flex:1,style:{display:"block"}}),b++},this),this.setLayout(this._layout),this.listen(e.touchEvents.TOUCHSTART,f.bind(this.onTouchStart,this));var c=this.getActiveChoice();c!==null&&this.setActiveChoice(c);return this},setActiveChoice:function(a){if(!f.isEmpty(this.refs)){this.setProperty("activeChoice",a),this.refs["choice"+a];for(var b=0;b<this.getChoices().length;b++){var c=this.findRef("choice"+b);b!==a?c.setDown(!1):c.setDown(!0)}this.getOwner()&&this.getOwner().toggleChoiceSelectedAtIndex&&this.getOwner().toggleChoiceSelectedAtIndex(this,a)}},onTouchStart:function(a){button=this.refForEvent(a),button&&this.setActiveChoice(parseInt(button.getRef().replace(/choice/,""),10))},_findTouchTarget:function(a){var b=null;while(a.parentNode&&a.parentNode!=this.getNode()){if(a.className.match("bt-button"))return this.findRef(a.getAttribute("data-ref"));a=a.parentNode}return!1}}});b.Toggle=j}}),require.define({"views/tokenizer":function(a,b,c){__DEV__=0,a("tokenizer");var d=a("javelin/core"),e=a("JX"),f=a("util"),g=a("view"),h=a("javelin/dom"),i=a("views/typeahead").Typeahead,j=d.createClass({name:"Tokenizer",extend:g.View,properties:{tagName:"div",_tokenizerControl:null},members:{render:function(){var a=this.getNode();this._input=h.$N("input",{type:"text",sigil:"tokenizer"}),a.appendChild(this._input),this.setSigil("touchable"),this._tokenizerControl=new e.Tokenizer(a),a.onclick=f.bind(this._handleTouch,this)},focus:function(){this._tokenizerControl._focus.focus()},getTokens:function(){return this._tokenizerControl.getTokens()},_handleTouch:function(){this.focus()},setTypeahead:function(a){this.typeahead=a,this._tokenizerControl.setTypeahead(this.typeahead),this._tokenizerControl.start(),this.typeahead.listen("select",e.bind(this,function(a){if(a&&a.__auto__data&&a.__auto__data.args){var b=a.__auto__data.args[0];this._tokenizerControl.addToken(b.id,b.name),this._tokenizerControl.refresh(),a.prevent()}}))}}});b.Tokenizer=j}}),require.define({"views/typeahead":function(a,b,c){__DEV__=0,a("typeahead_source");var d=a("javelin/core"),e=a("util"),f=a("view"),g=a("JX"),h=a("javelin/dom"),i=a("javelin/stratcom"),j=a("builder"),k=a("views/table").Table,l=d.createClass({name:"Typeahead",extend:f.View,construct:function(a){f.View.call(this,a)},events:["select","start"],properties:{tagName:"div",_table:null,_rootNode:null,label:null},setLabel:function(a){this.setProperty("label",a),this._label.innerHTML=a},members:{handleEvent:function(a){if(!this._stop&&!a.getPrevented()){var b=a.getType();b==="blur"?this.hideDropdown():b==="keydown"&&(a.getSpecialKey()==="esc"&&this.hideDropdown(),g.defer(g.bind(this,function(){this._value!==this._input.value&&this.refresh()})))}},focus:function(){this._input.focus()},hideDropdown:function(){this._table&&this._table.destroy(),delete this._table},refresh:function(){this._value=this._input.value,this._dataSource&&this._dataSource.didChange(this._value)},render:function(){this._rootNode=this.getNode(),this._label=h.$N("span"),this._input=h.$N("input",{type:"text"}),this._rootNode.appendChild(this._label),this._rootNode.appendChild(this._input),this.setSigil("touchable"),this._tableSource.onRowTap=g.bind(this,this.select),g.DOM.listen(this._input,["focus","blur","keypress","keydown"],null,g.bind(this,this.handleEvent))},select:function(a){if(a&&a._dataItem){var b=a._dataItem.display;this.invoke("select",a._dataItem).getPrevented()&&(b=""),this._value=this._input.value=b,this.hideDropdown()}},setDataSource:function(a){a.createNode=function(a){return a},a.setMaximumResultCount(2e3),a.bindToTypeahead(this),this._dataSource=a,this.start()},setDefaultRowHeight:function(a){this._tableSource._defaultRowHeight=a},setDropdownHeight:function(a){this._table.setHeight(a+"px")},setDropdownWidth:function(a){this._table.setWidth(a+"px")},setRenderer:function(a){this._tableSource._renderer=a},showResults:function(a){if(!a.length)this.hideDropdown();else{if(!this._table){this._table=j.build({view:k,style:{display:"-webkit-box"},owner:this._tableSource},this._tableSource);var b=this._table.getNode();this._rootNode.appendChild(b)}this._tableSource._dataItems=a,this._table.refresh()}},_tableSource:{_dataItems:[],_renderer:null,_defaultRowHeight:50,_defaultMatchDelegate:function(a){return!0},_defaultRenderer:function(a){return j.build({content:a.display,className:"jx-result",style:{height:"50px"}})},numberOfSections:function(){return 1},numberOfRowsInSection:function(a){return this._dataItems.length},cellForRowInSection:function(a,b){var c=this._renderer||this._defaultRenderer,d=this._dataItems[a],e=c(d),f=e.getNode();f&&(f._dataItem=d);return e},sectionHeaderAtIndex:function(){return null},heightForSectionHeader:function(a){return 0},heightForRowInSection:function(a,b){return this._defaultRowHeight}},setAllowNullSelection:function(){},setInputNode:function(a){this._input=a,this._rootNode=a.parentElement},start:function(){this.invoke("start")},submit:function(){return!0}}}),m=d.createClass({extend:g.TypeaheadSource,construct:function(a){g.TypeaheadSource.call(this),a&&e.forEach(a,function(a){this.addResult(a)},this)},members:{didChange:function(a){this.matchResults(a)}}});b.Typeahead=l,b.TypeaheadStaticSource=m}})